<PP xmlns="https://niap-ccevs.org/cc/v1" xmlns:h="http://www.w3.org/1999/xhtml" name="file encryption">  
   
   <PPReference title="PP Reference" id="ID003">
      
      <ReferenceTable>
         
         <PPTitle>Application Software Extended Package for File Encryption </PPTitle>
         
         <PPVersion>1.1-DRAFT</PPVersion>
         
         <PPAuthor>National Information Assurance Partnership</PPAuthor>
         
         <PPPubDate>2014-11-10</PPPubDate>
         
         <PPCertificationID>unassigned</PPCertificationID>
         
         <CCVersion>Version 1.0</CCVersion>
         
         <Keywords>file encryption; encryption</Keywords>
         
         <entry>
            
            <name>Registration</name>
            
            <description>National Information Assurance Partnership</description>
            
         </entry>
         
      </ReferenceTable>
      
   </PPReference>
   
   <RevisionHistory>
      
      <entry>
         
         <version>v 0.1</version>
         
         <date>2014-07-25</date>
         
         <subject>Initial Release</subject>
         
      </entry>
      
      <entry>
         
         <version>v 1.0</version>
         
         <date>2014-11-10</date>
         
         <subject>Public release, incorporating comments received</subject>
         
      </entry>
      
   </RevisionHistory>
   
   <chapter title="Introduction" id="int">
      
      <section title="Overview" id="ppoverview"> This Extended Package (EP) describes security
         requirements for an encryption product that is configurable for the data it encrypts and is
         intended to provide a minimal, baseline set of requirements that are targeted at mitigating
         well defined and described threats. However, this EP is not complete in itself, but rather
         extends the Protection Profile for Application Software (<cite linkend="bibAppPP"></cite>). This
         introduction will describe the features of a compliant Target of Evaluation, and will also
         discuss how this EP is to be used in conjunction with the <cite linkend="bibAppPP"></cite>. 
      </section>
      
      <section id="glossary" title="Terms">The following sections provide both Common Criteria and
         technology terms used in this Extended Package. 
         
         <glossary>
            
            <entry>
               
               <term><abbr title="Common Criteria">CC</abbr></term>
               
               <description>Common Criteria for Information Technology Security
                  Evaluation.
               </description>
               
            </entry>
            
            <entry>
               
               <term><abbr title="Extended Package">EP</abbr></term>
               
               <description>An implementation-independent set of security requirements for a category
                  of products, which extends those in a Protection Profile.
               </description>
               
            </entry>
            
            <entry>
               
               <term><abbr title="Protection Profile">PP</abbr></term>
               
               <description>An implementation-independent set of security requirements for a category
                  of products.
               </description>
               
            </entry>
            
            <entry>
               
               <term><abbr title="Security Target">ST</abbr></term>
               
               <description>A set of implementation-dependent security requirements for a specific
                  product.
               </description>
               
            </entry>
            
            <entry>
               
               <term><abbr title="Target of Evaluation">TOE</abbr></term>
               
               <description>The product under evaluation. In this case, application software and its
                  supporting documentation.
               </description>
               
            </entry>
            
            <entry>
               
               <term><abbr title="TOE Security Functionality">TSF</abbr></term>
               
               <description>The security functionality of the product under evaluation.</description>
               
            </entry>
            
            <entry>
               
               <term><abbr title="TOE Security Policy">TSP</abbr></term>
               
               <description>The set of rules that regulate how assets are managed, protected and
                  distributed within a TOE.
               </description>
               
            </entry>
            
            <entry>
               
               <term><abbr title="TOE Summary Specification">TSS</abbr></term>
               
               <description>A description of how a <abbr linkend="TOE"></abbr> satisfies the SFRs in a <abbr linkend="ST"></abbr>. 
               </description>
               
            </entry>
            
            <entry>
               
               <term><abbr title="Security Functional Requirement">SFR</abbr></term>
               
               <description>A requirement for security enforcement by the <abbr linkend="TOE"></abbr>.
                  
               </description>
               
            </entry>
            
            <entry>
               
               <term><abbr title="Security Assurance Requirement">SAR</abbr></term>
               
               <description>A requirement to assure the security of the <abbr linkend="TOE"></abbr>.
                  
               </description>
               
            </entry>
            
            
            
            <entry>
               
               <term>Administrator</term>
               
               <description> Authorized Users with higher privileges and typically handle configuration
                  and management functions, such as configuring and updating the TOE. 
               </description>
               
            </entry>
            
            <entry>
               
               <term>Authorization factor (AF) </term>
               
               <description> a value submitted by the user, present on the host, or present on a
                  separate protected hardware physical device used to establish that the user (and
                  potentially the host) is in the community authorized to use the TOE. The authorization
                  factors are used to generate the KEK. Note that these AFs are not used to establish
                  the particular identity of the user. 
               </description>
               
            </entry>
            
            <entry>
               
               <term>Authorized User </term>
               
               <description> a user who has been provided Authorization factors by the administrator to
                  use the TOE. 
               </description>
               
            </entry>
            
            <entry>
               
               <term>Data Encryption </term>
               
               <description> the process of encrypting all user data written to volatile memory.
                  
               </description>
               
            </entry>
            
            <entry>
               
               <term>Deterministic Random Bit Generator (DRBG)</term>
               
               <description> a cryptographic algorithm that produces a sequence of bits from a secret
                  initial seed value. Without knowledge of the seed value, the output sequence should be
                  unpredictable up to the security level of the DRBG. 
               </description>
               
            </entry>
            
            <entry>
               
               <term>Entropy Source </term>
               
               <description> this cryptographic function provides a seed for a random bit generator by
                  accumulating the outputs from one or more noise sources. The functionality includes a
                  measure of the minimum work required to guess a given output and tests to ensure that
                  the noise sources are operating properly. 
               </description>
               
            </entry>
            
            <entry>
               
               <term>File/Set of files </term>
               
               <description> the user data that is selected to be encrypted, which can include
                  individual file encryption (with a FEK per file) or a set of files encrypted with a
                  single FEK. 
               </description>
               
            </entry>
            
            <entry>
               
               <term>File Authentication Key (FAK) </term>
               
               <description> the secret value used as input when a keyed hash function is used to
                  perform data authentication. 
               </description>
               
            </entry>
            
            <entry>
               
               <term>File Encryption Key (FEK) </term>
               
               <description> the key that is used by the encryption algorithm to encrypt the selected
                  user data on the host machine. 
               </description>
               
            </entry>
            
            <entry>
               
               <term>Key Encryption Key (KEK) </term>
               
               <description> the key that is used to encrypt the FEK. </description>
               
            </entry>
            
            <entry>
               
               <term>Keying material </term>
               
               <description> the KEK, FEK, authorization factors and random numbers or any other values
                  from which keys are derived. 
               </description>
               
            </entry>
            
            <entry>
               
               <term>Noise Source </term>
               
               <description> the component of an RBG that contains the non-deterministic,
                  entropy-producing activity. 
               </description>
               
            </entry>
            
            <entry>
               
               <term>Operational Environment </term>
               
               <description> hardware and software that are outside the TOE boundary that support the
                  TOE functionality and security policy, including the host platform, its firmware, and
                  the operating system. 
               </description>
               
            </entry>
            
            <entry>
               
               <term>Password </term>
               
               <description> A short string of characters used for authorization to the data on the
                  device. 
               </description>
               
            </entry>
            
            <entry>
               
               <term>Passphrase</term>
               
               <description> A long string of characters that may be used for authorization to the data
                  on the device. 
               </description>
               
            </entry>
            
            <entry>
               
               <term>Random Bit Generator (RBG) </term>
               
               <description> a cryptographic function composed of an entropy source and DRBG that is
                  invoked for random bits needed to produce keying material 
               </description>
               
            </entry>
            
            <entry>
               
               <term>Sensitive Data </term>
               
               <description> Any data of which the compromise with respect to loss, misuse, or
                  unauthorized access to or modification of could adversely affect the interest of the
                  TOE user. 
               </description>
               
            </entry>
            
            <entry>
               
               <term>Shutdown </term>
               
               <description> power down or unintentional loss of power of the TOE or host platform.
                  
               </description>
               
            </entry>
            
            <entry>
               
               <term>System files </term>
               
               <description> Files that reside on the host machine that are used in the operation of
                  the file encryption software. 
               </description>
               
            </entry>
            
            <entry>
               
               <term>Temporary File - </term>
               
               <description> a file created by an application for short term storage of sensitive data.
                  
               </description>
               
            </entry>
            
            <entry>
               
               <term>Trusted Host </term>
               
               <description> Source/destination host configured and maintained to provide the TOE with
                  appropriate IT security commensurate with the value of the user data protected by the
                  TOE. 
               </description>
               
            </entry>
            
            <entry>
               
               <term>Unauthorized User </term>
               
               <description> a user who has not been authorized to use the TOE and decrypt encrypted
                  user data. 
               </description>
               
            </entry>
            
            <entry>
               
               <term>User Data </term>
               
               <description> All data that originate on the host, or is derived from data that
                  originate on the host, excluding system files and signed firmware updates from the TOE
                  manufacturer. 
               </description>
               
            </entry>
            
            <entry>
               
               <term>Volatile memory </term>
               
               <description> memory that loses its content when power is turned off. </description>
               
            </entry>
            
            <entry>
               
               <term>Zeroize</term>
               
               <description> this term is used to make a distinction between dereferencing a memory
                  location and actively overwriting it with a constant. Keying material needs to be
                  overwritten when it is no longer needed. 
               </description>
               
            </entry>
            
         </glossary>
         
      </section>
      
      <section title="Compliant Targets of Evaluation" id="complianttargets"> This EP specifically
         addresses encryption of a set of data. This EP addresses the primary threat that an
         unauthorized user will obtain access to a host machine containing encrypted information and be
         able to extract the sensitive data through the process of decryption. The Target of Evaluation
         (TOE) defined in this EP is an encryption product that will inherently encrypt all of that
         data that the user selects to encrypt. For ease of explanation, &#8220;file&#8221; will frequently be used
         to refer to the object that is encrypted (however, it could be any number of things &#8211; folders,
         volumes, containers, etc.).<br xmlns=""> There are two use cases for this EP. First, the traditional
         ability to encrypt files and power down the machine and know the data is securely protected.
         Second, the ability to encrypt a file on a machine and then send the encrypted file securely
         using a non-encrypted data in transit method. 
      </section>
      
      <section title="Use Cases" id="usecases">
         
         <subsection title="Usage and Major Security Features of the Target of Evaluation (TOE)" id="usagetoe"> File encryption is the process of encrypting individual files or sets of
            files (or volumes, or containers, etc.) on an end user device and permitting access to the
            encrypted data only after proper authentication is provided. Encryption products that
            conform to this EP must render information inaccessible to anyone (or, in the case of other
            software on the machine, anything) that does not have the proper authentication credential.
            For the purposes of this EP, &#8220;set of files&#8221; describes implementations that use one
            encryption key to encrypt more than one file. <br xmlns=""> The foremost security objective of file
            encryption is to force an adversary to perform a cryptographic exhaust against a
            prohibitively large key space. Note that this can be achieved only if the authorized user of
            the file encryption product follows good security practices and does not store an
            authorization factor in the clear. <br xmlns=""> Technology is changing at a rapid rate and the
            definition of mobile devices and traditional laptop/PC devices is quickly merging.
            Requirements will diverge slightly for Mobile vs Laptop/PC and the Assurance Activities will
            describe any differences. For this EP, the following table will be used to explain the
            general principles for several key concepts, including power state and memory management.<br xmlns="">
            
            <table xmlns="">
               
               <tr class="header">
                  
                  <th>Topic</th>
                  
                  <th>Mobile</th>
                  
                  <th>Laptop/PC</th>
                  
               </tr>
               
               <tr>
                  
                  <td>Memory Management - when the TOE is running</td>
                  
                  <td>The TOE must initiate the request to clear the cryptographic keys and plaintext
                     data, but the TOE Platform will handle the actual instruction through memory
                     management queue. (<cite xmlns="https://niap-ccevs.org/cc/v1" linkend="bibAppPP"></cite> or MDF PP) (The assurance is dependent
                     on the TOE Platform to perform the action of clearing the plaintext data and
                     cryptographic keys.)
                  </td>
                  
                  <td>The TOE is responsible for handling the clearing of cryptographic keys and plaintext
                     in volatile memory by overwrite or zeroization. (Risk: Non-volatile memory (page
                     files) may still contain the original plaintext data and keys. Reboot is required to
                     ensure that this memory space has been wiped. This risk can be minimized by following
                     good operational practices.) 
                  </td>
                  
               </tr>
               
               <tr>
                  
                  <td>Memory Management - when the TOE application cleanly closes</td>
                  
                  <td>The TOE must initiate the request to clear the cryptographic keys and plaintext
                     data, but the TOE Platform will handle the actual instruction through memory
                     management queue. (<cite xmlns="https://niap-ccevs.org/cc/v1" linkend="bibAppPP"></cite> or MDF PP) (The assurance is dependent
                     on the TOE Platform to perform the action of clearing the plaintext data and
                     cryptographic keys.)
                  </td>
                  
                  <td>The TOE's application memory space is gone and all volatile memory associated with
                     the application no longer exists. All plaintext data and plaintext keys have been
                     destroyed. (Risk: Non-volatile memory (page files) may still contain the original
                     plaintext data and keys. Reboot is required to ensure that this memory space has been
                     wiped. This risk can be minimized by following good operational practices.) 
                  </td>
                  
               </tr>
               
               <tr>
                  
                  <td>Memory Management - Lockscreen</td>
                  
                  <td>If the TOE is running and a plaintext document is displayed on the screen the user's
                     data is not protected.
                  </td>
                  
                  <td>Lockscreen/Standby/Hibernate happen invisibly to the TOE, therefore if a plaintext
                     document is displayed on the desktop during one of these events, the user's data is
                     assumed to be not protected. 
                  </td>
                  
               </tr>
               
               <tr>
                  
                  <td>Memory Management - unintentional shutdown</td>
                  
                  <td>If the TOE is running and a plaintext document is displayed on the screen and an
                     unintentional shutdown occurs, there is a chance that temporary files may still exist
                     but all volatile memory will be destroyed over time (pending cold boot attack).
                  </td>
                  
                  <td>If the TOE is running and a plaintext document is displayed on the desktop and an
                     unintentional shutdown occurs, there is a chance that temporary files may still exist
                     but all volatile memory will be destroyed.
                  </td>
                  
               </tr>
               
            </table> When the user is finished working with sensitive data from an encrypted file, the
            file encryption product must re-encrypt this data and is responsible for removing all keying
            materials and any plaintext data from the encryption product&#8217;s volatile memory or any
            temporary files (non-volatile memory) it creates during the decryption/encryption process.
            This functionality can be met by a combination of the TOE and the Operational Environment.
            <br xmlns=""> The data that is to be secured by the encryption product is encrypted using a File
            Encryption Key (FEK). A file encryptor may have zero or more Key Encryption Keys (KEKs) that
            protect (encrypt) the FEK. The number of keys and the types of keys may vary, but the design
            should follow one of the following models:<br xmlns="">
            
            <ol xmlns="">
               
               <li>Condition a Password/Passphrase directly into a FEK</li>
               
               <li>Condition a Password/Passphrase into a KEK that is used to encrypt the randomly
                  generated FEK directly or through a chaining of more than one KEK (these KEKs would be
                  randomly generated).
               </li>
               
               <li>Use a software certificate or an external token (e.g. smartcard with a RSA or ECC key
                  pair) to protect the randomly generated FEK. The external token will later be referred
                  to as an &#8220;external entity&#8221; in this EP, and contains &#8220;external authorization
                  factors.&#8221;
               </li>
               
            </ol> From a terminology standpoint, a KEK is either a symmetric key (as in case 2) or an
            asymmetric key pair (as in case 3), and is used for both encryption and decryption of the
            FEK. If a distinction needs to be made between the public key (which encrypts the FEK) and
            the private key (which decrypts the FEK), this is done in the requirements and the assurance
            activities below.<br xmlns=""> Secure design and use of a file encryption product must be addressed
            on multiple levels. From a software-design standpoint, the product must employ strong
            cryptography, robust error handling, and ensure complete deletion of all keying materials
            and plaintext data stored in its volatile memory and/or non-volatile memory (platform
            dependent). From a system standpoint, the product may need to be configured to interact with
            other hardware or software (smart cards, cryptographic libraries, etc.) that are required on
            the machine. Finally, from a user standpoint, the product must be simple enough to operate
            to prevent the user from simply not encrypting their files, and must include instructions to
            promote secure operational usage. If any of these perspectives are ignored, then secure use
            of the file encryption product is compromised. Therefore, this EP addresses both the
            cryptography and implementation requirements necessary to design a secure product, as well
            as the user and configuration guidance necessary to securely operate the file encryption
            software (for example, how to disable hibernation).<br xmlns=""> The TOE may be capable of
            supporting multiple users with different authorization factors, such that different users
            are able to use the same platform and not be able to read each other's encrypted files. The
            TOE may also support the ability for users to share an encrypted file without sharing an
            authorization factor, but this is not required. In order to claim this capability, the TOE must allow
            sharing of at least one encrypted resource among different users of the TOE who possess
            different authorization factors (e.g., two different smartcards, two different passwords, one
            using a password and another using a smartcard). If this capability is supported, then the ST
            author adds FDP_PRT_EXT.2 (and the associated application notes and assurance activities) to
            the ST. <br xmlns=""> The vendor is required to provide
            configuration guidance (AGD_PRE, AGD_OPE) to correctly install and administer the TOE for
            every operational environment supported (for example, for every OS supported by the
            product).<br xmlns=""> Some products support the use of a recovery key that can be used to recover
            the encrypted data if the FEK is lost. This functionality must be configurable so it can be
            turned off and cannot diminish the overall strength of the FEK.<br xmlns="">
            <b xmlns="">Authorization</b> One or more authorization factors must be established before data can
            be encrypted. This authorization factor(s) must be presented to the file encryption product
            in order for the user to request that the product decrypt the data. Authorization factors
            may be uniquely associated with individual users or may be associated with a community of
            users. The TOE is not required to support multiple types of authorization factors (e.g.,
            both passphrases and external authorization factors). If the ST author defines additional
            authorization factors, they must be fully documented and cannot diminish the strength of the
            passphrase and/or external token authorization factors. <br xmlns=""> All compliant TOEs must
            provide (or support, in the case of an external authorization factor) at least one of the
            following authorization factor options and be able to support the configuration of: <br xmlns="">
            
            <ul xmlns="">
               
               <li>A password/passphrase that supports at least a 64 character space, </li>
               
               <li>An external token (e.g. smartcard) or software capability (on the host, for instance)
                  containing a software certificate for the user with RSA or ECC key pairs may be
                  used.<br> The implementation of this capability is largely outside the TOE boundary
                  (depending on the particulars of the implementation); however, the TOE must interface
                  with the external entity; be able to specify the use of RSA or ECC CDH to protect the
                  FEK (even if this specification is implicit rather than explicit); and be able to
                  provide information to the external entity in order to unlock the private key (if
                  required by the external entity). The computations involving the private key are
                  performed by the cryptographic capability of the external entity. 
               </li>
               
            </ul> The password/passphrase authorization factors must be conditioned such that they are
            at least the same size (bit length) as the key they are protecting.<br xmlns=""> A
            password/passphrase authentication factor with low entropy reduces the overall algorithm
            strength. While this EP does not dictate how these authentication factors are created, a
            good operational practice is for an administrator to generate the password or passphrase to
            ensure sufficient entropy. Once the password/passphrase is entered by the user, it is
            conditioned by the TOE prior to being provided as an encryption key. Passphrases are
            preferred over passwords, since it is easier for users to remember and type in a sequence of
            words than recall a password and type in a long string of random characters. The
            requirements in Appendix C for the selected authorization factors should be included in the
            ST. <b xmlns="">Encryption</b> One or more authorization factors must be established or entered
            before data can be encrypted or decrypted, respectively. Entry of an incorrect authorization
            factor should not result in the user seeing an improperly decrypted file. Entry of a correct
            or incorrect authorization factor should not aid an attacker in guessing the KEK or
            FEK.<br xmlns=""> If the cryptography used to generate, handle, and protect keys or authorization
            factors is sufficiently robust and if the implementation has no critical mistakes, the only
            option for an adversary who obtains the encrypted information without the authorization
            factors or KEK must be to exhaust the encryption key space of the KEK or FEK for data
            decryption. Note that if passwords are used, a password might offer less strength than
            exhausting over the potential number of keys for the data encryption algorithm (AES).
            Furthermore, if the password is the only authorization factor unknown to the adversary, then
            the key space is the minimum of the work needed to exhaust the KEK or FEK or to exhaust the
            number of possible passwords. As a consequence, the next generation of this EP may require
            support for more robust authorization factors.<br xmlns=""> If external authorization factors are
            used, the external device generally requires some factor (such as a PIN or password) to
            unlock the private key. In these cases, the PIN or password may have a similar smaller
            exhaust space than the KEK or FEK, and this should be taken into account when choosing a
            product that is conformant to this EP.<br xmlns=""> The data being secured by the file encryption
            product must be encrypted using a FEK. If the FEK is protected by the KEK, the FEK will be
            generated using a Deterministic Random Bit Generator (DRBG) that meets the requirements of
            FCS_RBG_EXT.1 (from the <cite linkend="bibAppPP"></cite>). The DRBG comprises an entropy source
            and the DRBG algorithm. A properly seeded DRBG provides enough entropy to be of equal or
            greater value than the exhaust space of the KEK.<br xmlns="">
            <b xmlns="">Administration</b> The base requirements of the TOE do not require the TOE to maintain an
            administrative role (the notion of an administrator of the TOE is that there exists a subset
            of the users of the TOE that have greater &#8220;trust&#8221; than the general user population and who
            have specific responsibilities). Typically, administrators possess privilege to invoke
            functionality on the TOE that is not available to general users. For file encryption
            products, however, once the product is installed there should be little need for
            administrative involvement. <b xmlns="">Authorized Users</b> Authorized users are expected to adhere
            to the user guidance to minimize the risk of compromised data. Authorization is determined
            by possessing and providing the TOE the correct authorization factor(s) to enable the file
            encryption product&#8217;s functionality. It is the responsibility of the authorized users of the
            host machine to secure and protect the host machine and authorization factors for the TOE
            while it is officially in their possession. Authorized users will not leave/store
            unprotected authorization factors (e.g., passwords, passphrases) in written or digital form
            on or around the host machine. The user will be provided appropriate guidance to maintain a
            secure TOE. <b xmlns="">Data Authentication (optional)</b> Because modification of ciphertext data
            for certain modes of encryption will enable unidentified plaintext manipulation, care must
            be taken by the TOE to mitigate against forged or maliciously modified ciphertext data. The
            EP defines requirements for how the TOE must provide data authentication services, allowing
            the TOE to implement authenticated block cipher, keyed hash function or asymmetric signing
            features. Depending on the implementation, the TOE will be responsible for meeting at least
            one of the aforementioned requirements. In all cases, unsuccessful authentication of the
            data should not allow the user to see the decrypted ciphertext and notification should be
            provided to the user if such an event were to occur.<br xmlns=""> A keyed hashing service may also
            be used to accomplish data authentication. This will involve using an approved keyed hashing
            service in accordance with FCS_COP.1(4) and proper protection of the File Authentication Key
            (FAK); the FAK being the secret value used as input to the keyed hash function. FAKs should
            be numerically different from the FEK, but will be protected in all of the same manners as
            the FEK. The primary requirement dictating implementation of data authentication using a
            keyed hash function is FDP_AUT_EXT.2.<br xmlns=""> Lastly, asymmetric signing in conjunction with a
            secure hash function may be used to authenticate the data. The implementation must use an
            approved signing algorithm in accordance with FCS_COP.1(2) (from the <cite linkend="bibAppPP"></cite>) and an approved secure hashing function in accordance with
            FCS_COP.1(3) (from the <cite linkend="bibAppPP"></cite>). The primary requirement addressing data
            authentication via asymmetric signing is FDP_AUT_EXT.3. 
         </subsection>
         
         <subsection title="The TOE and Its Supporting Environment" id="supenv"> Since the TOE is
            purely a software solution, it must rely on the TOE Operational Environment (system
            hardware, firmware, and operating system) for its execution domain and its proper usage. The
            vendor is expected to provide sufficient installation and configuration instructions (for
            each platform listed in the ST) to identify an Operational Environment with the necessary
            features and to provide instructions for how to configure it correctly and securely. <br xmlns="">
            The EP contains requirements (Section 4) that must be met by either the TOE or the platform
            on which it operates. A &#8220;platform&#8221; is defined as a separate entity whose functions may be
            used by the TOE, but is not part of the TOE. A third-party library used by the TOE is not
            considered part of the TOE&#8217;s &#8220;platform&#8221;, but (for instance) cryptographic functionality that
            is built into an Operating System on which the TOE executes can be considered part of the
            platform. <br xmlns=""> Likewise, an external entity (such as a smartcard) that performs
            cryptographic operations with respect to the FEK would also be considered a part of the &#8220;TOE
            Platform."<br xmlns=""> The ST author will make the appropriate selection based on where
            that element is implemented. It is allowable for some elements in a component to be
            implemented by the TOE, while other elements in that same component may be implemented by
            the platform; in these cases, further guidance is given in the application notes and
            assurance activities.<br xmlns=""> In some cases, the TOE vendor will have to provide specific
            configuration guidance for the Operational Environment to enable the TOE to meet its
            security objectives. These include:<br xmlns=""> For non-mobile systems:<br xmlns="">
            
            <ul xmlns="">
               
               <li>Instructions for how to configure the operational environment so that the system
                  powers down completely after a period of user inactivity for every operating system that
                  the product supports;
               </li>
               
               <li>Instructions for how to disable power managed state (e.g., hibernate/sleep)
                  capabilities 
               </li>
               
            </ul> For mobile systems:<br xmlns="">
            
            <ul xmlns="">
               
               <li>Instructions for how to configure the operational environment to provide necessary
                  behavior in support of TOE functionality when transition to a locked state after
                  inactivity period and manually engaging the lock functionality.
               </li>
               
               <li>Instructions on how to configure the operational environment such that it is compliant
                  with the Mobile Device Fundamentals Protection Profile.
               </li>
               
            </ul> It should be noted that if the TOE possesses the capability to correctly protect
            information in one or more of an underlying platform's power managed modes, they can use the
            FDP_PM_EXT.1 requirement in Appendix B.<br xmlns=""> Authorized users of the TOE are those users
            possessing valid authorization factors for the TOE. While some of these functions specified
            in the EP might be considered &#8220;administrative&#8221; functions for other types of TOEs, for file
            encryption products it is the expectation that all of these functions can be performed by
            the end user of the software. 
         </subsection>
         
      </section>
      
   </chapter>
   
   <chapter title="Conformance Claims" id="conf">
      
      <cclaims>
         
         <cclaim id="Conformance Statement">
            
            <description> The Protection Profile for Application Software (App PP) defines the baseline
               Security Functional Requirements (SFRs) and Security Assurance Requirements (SARs) for
               application software products. This EP serves to extend the App PP baseline with
               additional SFRs and associated Assurance Activities specific to an email client. Assurance
               Activities are the actions that the evaluator performs in order to determine an email
               client&#8217;s compliance to the SFRs.<br xmlns=""> This EP conforms to Common Criteria <cite linkend="bibCC"></cite> for Information Technology Security Evaluation, Version 3.1, Revision
               4. It is CC Part 2 extended and CC Part 3 conformant. In order to be conformant to this
               EP, the ST must include all components in this EP and the associated App PP that are:
               
               <ul xmlns="">
                  <li>unconditional (which are always required)</li>
                  
                  <li>selection-based (which are required when certain selections are chosen in the
                     unconditional requirements)
                  </li>
                  
               </ul> and may include optional and/or objective components that are desirable but not
               required for conformance. 
            </description>
            
         </cclaim>
         
      </cclaims>
      
      <section title="How to Use This Extended Package" id="howto"> As an EP of the <cite linkend="bibAppPP"></cite>, it is expected that the content of both this EP and the <cite linkend="bibAppPP"></cite> be appropriately combined in the context of each product-specific
         Security Target. This EP has been specifically defined such that there should be no difficulty
         or ambiguity in so doing. An ST must identify the applicable versions of the <cite linkend="bibAppPP"></cite> (see http://www.niap-ccevs.org/pp/ for the current version) and this EP
         in its conformance claims. When requirements are referenced from the <cite linkend="bibAppPP"></cite>, a short notation is included. 
      </section>
      
   </chapter>
   
   <chapter title="Security Problem Description" id="spd"> The primary asset that is being protected
      is the sensitive user data stored on a system. The threat model thus focuses on a host machine
      that has been compromised by an unauthorized user. This section addresses threats to the TOE
      only. 
      <section title="Threats" id="threats"> A threat consists of a threat agent, an asset, and
         an adverse action of that threat agent on that asset. The model in this EP only addresses
         risks that arise from the host machine being compromised by an unauthorized user.<br xmlns=""> For
         this EP, the TOE is not expected to defend against all threats related to malicious software
         that may reside in user data files. For instance, the TOE is not responsible for detecting
         malware in the data selected by the user for encryption (that is a responsibility of the host
         environment). Once the file encryption product is operational in a host system, the threats
         against the data from potentially malicious software on the host are also not in the threat
         model of this EP. For example, there are no requirements in this EP addressing a malicious
         host capturing a password-based authorization factor, nor a malicious process reading the
         memory of an application program that is operating on a decrypted file.<br xmlns=""> Note that this EP
         does not repeat the threats identified in the <cite linkend="bibAppPP"></cite>, though they all
         apply given the conformance and hence dependence of this EP on the <cite linkend="bibAppPP"></cite>.
         Note also that while the <cite linkend="bibAppPP"></cite> contains only threats to the ability of
         the TOE to provide its security functions, this EP focuses on threats to resources in the
         operational environment. Together the threats of the AS PP and those defined in this EP define
         the comprehensive set of security threats addressed by a file encryption TOE. 
         
         <threats>
            
            <threat id="T.KEYING_MATERIAL_COMPROMISE">
               
               <description>
                  <b xmlns="">Compromise of Keying Material:</b> Attacks against the encryption product could take
                  several forms; for example, if there is a weakness in the random number generation
                  mixing algorithm or the data sources used in random number generation are guessable,
                  then the output may be guessable as well. If an attacker can guess the output of the
                  pseudorandom number generator (PRNG) at the time an encryption key is made, then the
                  output may be used to recreate the keying material and decrypt the protected files. As
                  the encryption program runs, it will store a variety of information in memory. Some of
                  this information, such as random bit generation (RBG) inputs, RBG output, copies of the
                  plaintext file, and other keying material, could be very valuable to an attacker who
                  wishes to decrypt an encrypted file. If the encryption product does not wipe these
                  memory spaces appropriately, an attacker may be able to recreate the encryption key and
                  access encrypted files. 
               </description>
               
               <objective-refer ref="O.INSERT">
                  
                  <rationale></rationale>
                  
               </objective-refer>
               
            </threat>
            
            <threat id="T.KEYSPACE_EXHAUST">
               
               <description>
                  <b xmlns="">Brute Force Attack:</b> The protection of the data involves encrypting said data
                  assuming an attacker may have significant computing resources at their disposal. Several
                  ciphers have already been broken through brute-force attacks because the length of the
                  keys used in those ciphers was too short to provide protection against a concerted
                  computing effort to discover those keys. Because protection of the data may rely on a
                  chaining of keys and encryption mechanisms, there are many opportunities for brute force
                  attacks against each potential key in the chain, such that the weakest link in the chain
                  of factors/keys will determine the overall strength against a brute force attack.
                  
               </description>
               
               <objective-refer ref="O.INSERT">
                  
                  <rationale>INSERT</rationale>
                  
               </objective-refer>
               
            </threat>
            
            <threat id="T.PLAINTEXT_COMPROMISE">
               
               <description>
                  <b xmlns="">Plaintext Compromise:</b> Unlike full disk encryption, selectable encryption products
                  also need to protect against data leaks to other applications on the machine. Many file
                  creators and editors store temporary files as the user is working on a file, and restore
                  files if the machine experiences an interrupt while a file is open. Any of these files,
                  if not properly protected or deleted, could leak information about a protected file to
                  an attacker. Other applications might also access volatile or non-volatile memory
                  released by the file encryption product, and the software used to create files prior to
                  encryption may retain information about the file even after it has been encrypted. As
                  the user creates and saves a new document, the plaintext will be stored on the machine's
                  hard drive. An attacker could then search for the plaintext of the sensitive, encrypted
                  information. An attacker may not even have to access the encrypted file for the
                  protected information to be compromised. When the user wishes to encrypt the document,
                  this plaintext file should be replaced with the new encrypted version. For non-mobile
                  devices, it is expected that if the volatile and/or non-volatile memory space where the
                  plaintext file was stored is merely released back to the machine without being first
                  wiped clean of the data that was stored there, then the information the user wishes to
                  protect will still be accessible. While protection of the encryption algorithm itself is
                  vital, memory must also be properly managed by the file encryption product or the TOE
                  platform in order for security to remain intact. For mobile devices, it is assumed that
                  the File Encryption product will not be responsible for providing memory management
                  cleanup and the environment's platform has met the Mobile Device Fundamentals Protection
                  Profile.<br xmlns=""> Additionally, some encryption products offer to create backup files. These
                  files are meant to be used in the event an encrypted file becomes corrupted and
                  incapable of being decrypted. Each backup file is a valuable resource to protect
                  information that the user cannot afford to lose; however, it also may provide another
                  route for an attacker to access the encrypted information. If the backup file is
                  insufficiently protected, then the attacker may choose to attempt to break into it,
                  rather than the copy of the encrypted file that the user would typically access.
                  
               </description>
               
               <objective-refer ref="O.INSERT">
                  
                  <rationale>INSERT</rationale>
                  
               </objective-refer>
               
            </threat>
            
            <threat id="T.TSF_FAILURE">
               
               <description>
                  <b xmlns="">TSF Failure:</b> Security mechanisms of the TOE generally build up from a primitive
                  set of mechanisms (e.g., memory management, privileged modes of process execution) to
                  more complex sets of mechanisms. Failure of the primitive mechanisms could lead to a
                  compromise in more complex mechanisms, resulting in a compromise of the TSF.
                  
               </description>
               
               <objective-refer ref="O.INSERT">
                  
                  <rationale>INSERT</rationale>
                  
               </objective-refer>
               
            </threat>
            
            <threat id="T.UNAUTHORIZED_DATA_ACCESS">
               
               <description>
                  <b xmlns="">Unauthorized Data Access:</b> The central functionality of the TOE is the protection
                  of resources under its control through encryption. In a shared resource environment,
                  users on a system may have access to administrative-level tools that are capable of
                  over-riding a system&#8217;s access control protections. Further, if the system were to be
                  lost or the system&#8217;s storage device stolen, the attacker could then look directly at the
                  storage device using low-level forensic tools in an attempt to access data for which
                  they are not authorized. However, the need to protect the data in these scenarios should
                  not interfere with the data-owner&#8217;s (or another user that has been granted access to
                  those data) ability to read or manipulate the data. 
               </description>
               
               <objective-refer ref="O.INSERT">
                  
                  <rationale>INSERT</rationale>
                  
               </objective-refer>
               
            </threat>
            
            <threat id="T.UNSAFE_AUTHFACTOR_VERIFICATION">
               
               <description>
                  <b xmlns="">Flawed Authentication Factor Verification:</b> When a user enters an authorization
                  factor, the TOE is required to ensure that the authorization factor is valid prior to
                  providing any data to the user; the purpose of verification is to ensure the FEK is
                  correctly derived. If the data is decrypted with an incorrectly derived FEK (the FEK is
                  conditioned from the password/passphrase or is decrypted by the KEK), then unpredictable
                  data will be provided to the user. If verification is not performed in a secure manner,
                  keying material or user data may be exposed or weakened. 
               </description>
               
               <objective-refer ref="O.INSERT">
                  
                  <rationale>INSERT</rationale>
                  
               </objective-refer>
               
            </threat>
            
            <threat id="T.PLAINTEXT_DATA_SPOOFING">
               
               <description>
                  <b xmlns="">Data Spoofing (optional):</b> For certain modes of encryption, it is possible for a
                  malicious person to modify ciphertext data to force unintended modification to the
                  underlying plaintext data, without the user being notified. There are various failures
                  that may occur on the part of the TOE, to include: failure to verify the integrity of
                  the data prior to decryption, failure to provide integrity on the sensitive data,
                  failure to use a cryptographic or secure hashing code and failure to differentiate the
                  File Authentication Key (FAK) from the FEK; the FAK is any secret value used as input to
                  a keyed hashing function or as part of an asymmetric authentication process.
                  
               </description>
               
               <objective-refer ref="O.INSERT">
                  
                  <rationale>INSERT</rationale>
                  
               </objective-refer>
               
            </threat>
            
         </threats>
         
      </section>
      
      <section title="Assumptions" id="assumptions">
         
         <assumptions>
            
            <assumption id="A.AUTHORIZED_USER">
               
               <description>Authorized users of the host machine are well-trained, not actively working
                  against the protection of the data, and will follow all provided
                  guidance.
               </description>
               
               <objective-refer ref="OE.INSERT">
                  
                  <rationale> INSERT </rationale>
                  
               </objective-refer>
               
            </assumption>
            
            <assumption id="A.AUTH_FACTOR">
               
               <description>An authorized user will be responsible for ensuring that all externally
                  derived authorization factors have sufficient strength and entropy to reflect the
                  sensitivity of the data being protected. This can apply to password- or
                  passphrase-based, ECC CDH, and RSA authorization factors.
               </description>
               
               <objective-refer ref="OE.INSERT">
                  
                  <rationale> INSERT </rationale>
                  
               </objective-refer>
               
            </assumption>
            
            <assumption id="A.EXTERNAL_FEK_PROTECTION">
               
               <description>External entities that implement ECC CDH or RSA that are used to encrypt
                  and decrypt a FEK have the following characteristics: <br xmlns="">meet National requirements
                  for the cryptographic mechanisms implemented; <br xmlns="">require authentication via a pin or
                  other mechanisms prior to allowing access to protected information (the decrypted FEK,
                  or the private key); <br xmlns="">implement anti-hammer provisions where appropriate (for
                  example, when a pin is the authentication factor). 
               </description>
               
               <objective-refer ref="OE.INSERT">
                  
                  <rationale> INSERT </rationale>
                  
               </objective-refer>
               
            </assumption>
            
            <assumption id="A.SHUTDOWN">
               
               <description>An authorized user will not leave the machine in a mode where sensitive
                  information persists in non-volatile storage (e.g., power it down or enter a power
                  managed state, such as a &#8220;hibernation mode&#8221;).
               </description>
               
               <objective-refer ref="OE.INSERT">
                  
                  <rationale> INSERT </rationale>
                  
               </objective-refer>
               
            </assumption>
            
            <assumption id="A.STRONG_OE_CRYPTO">
               
               <description>All cryptography implemented in the Operational Environment and used by the
                  TOE will meet the requirements listed in Appendix C of this EP. This includes
                  generation of external token authorization factors by a RBG.
               </description>
               
               <objective-refer ref="OE.INSERT">
                  
                  <rationale> INSERT </rationale>
                  
               </objective-refer>
               
            </assumption>
            
            <assumption id="A.PLATFORM_STATE">
               
               <description>The platform on which the TOE resides is free of malware that could
                  interfere with the correct operation of the product.
               </description>
               
               <objective-refer ref="OE.INSERT">
                  
                  <rationale> INSERT </rationale>
                  
               </objective-refer>
               
            </assumption>
            
            <assumption id="A.AUTHORIZED_CONFIGURATION">
               
               <description>Access and ability to modify the cryptographic configuration files may be
                  done only by authorized users.
               </description>
               
               <objective-refer ref="OE.INSERT">
                  
                  <rationale> INSERT </rationale>
                  
               </objective-refer>
               
            </assumption>
            
            <assumption id="A.KEK_SECURITY">
               
               <description>The KEK will be derived from a strong entropy source, attaining equal or
                  greater bit strength to that of the block cipher it is used in.
               </description>
               
               <objective-refer ref="OE.INSERT">
                  
                  <rationale> INSERT </rationale>
                  
               </objective-refer>
               
            </assumption>
            
            <assumption id="A.FILE_INTEGRITY ">
               
               <description>When the file is in transit, it is not modified, otherwise if that
                  possibility exists, the appropriate selections in Appendix B are chosen for Data
                  Authentication.
               </description>
               
               <objective-refer ref="OE.INSERT">
                  
                  <rationale> INSERT </rationale>
                  
               </objective-refer>
               
            </assumption>
            
         </assumptions>
         
      </section>
      
      
   </chapter>
   
   <chapter title="Security Objectives" id="obj">
      
      <section title="Security Objectives for the TOE" id="objtoe"> The Security Problem described in
         Section 2 will be addressed by a combination of cryptographic capabilities. Compliant TOEs
         will provide security functionality that addresses threats to the TOE and enforces policies
         that are imposed by law and regulation. The following subsections provide a description of the
         security objectives required to meet the threats/policies previously discussed. The
         description of these security objectives are in addition to that described in the <cite linkend="bibAppPP"></cite>.<br xmlns=""> Note: in each subsection below particular security objectives are
         identified (highlighted by O.) and they are matched with the associated security functional
         requirements (SFRs) that provide the mechanisms to satisfy the objectives.<br xmlns=""> The Security
         Objectives are the requirements for the Target of Evaluation (TOE) and for the Operational
         Environment derived from the threats in Section 2. 
         <SOs>
            
            <SO id="O.KEY_MATERIAL_PROTECTION">
               
               <description>
                  <b xmlns="">Protection of Key Material:</b> The TOE must ensure that plaintext key material used
                  in performing its operations is cleared once it is no longer needed. Key material must
                  be identified; its use and intermediate storage areas must also be identified; and then
                  those storage areas must be cleared in a timely manner and without interruptions. For
                  example, authorization factors are only needed until the KEK is formed; at that point,
                  volatile memory areas containing the authorization factors should be cleared.<br xmlns="">
                  [FCS_CKM_EXT.4, FDP_PRT_EXT.1 (optional: FDP_PM_EXT.1)] 
               </description>
               
               <component-refer ref="INSERT REQ"></component-refer>
               
            </SO>
            
            <SO id="O.FEK_SECURITY">
               
               <description>
                  <b xmlns="">Encryption Using a Strong FEK and KEK:</b> In order to ensure that brute force
                  attacks are infeasible, the TOE must ensure that the cryptographic strength of the keys
                  and authorization factors used to generate and protect the keys is sufficient to
                  withstand attacks in the near-to-mid-term future. Password/passphrase complexity and
                  conditioning requirements are also levied to help ensure that a brute force attack
                  against these authorization factors (when used) has a similar level of resistance.<br xmlns="">
                  [FCS_CKM_EXT.2, FMT_SMF.1, FCS_COP.1(1), FCS_COP.1(5), FCS_IV_EXT.1
                  (optional: FCS_COP.1(6)) (selectable: FCS_CKM.1, FCS_CKM_EXT.1, FCS_COP.1(4)]
                  
               </description>
               
               <component-refer ref="INSERT REQ"></component-refer>
               
            </SO>
            
            <SO id="O.WIPE_MEMORY">
               
               <description>
                  <b xmlns="">Removal of Plaintext Data:</b> To address the threat of unencrypted copies of data
                  being left in non-volatile memory or temporary files where it may be accessed by an
                  unauthorized user, the TOE will ensure that plaintext data it creates is securely erased
                  when no longer needed. The TOE&#8217;s responsibility is to utilize the appropriate TOE
                  platform method for secure erasure, but the TOE is not responsible for verifying that
                  the secure erasure occurred as this will be the responsibility of the TOE platform.
                  <br xmlns=""> [FDP_PRT_EXT.1 (optional: FDP_PRT_EXT.2)] 
               </description>
               
               <component-refer ref="INSERT REQ"></component-refer>
               
            </SO>
            
            <SO id="O.PROTECT_DATA">
               
               <description>
                  <b xmlns="">Protection of Data:</b> The TOE will encrypt data to protect the data from
                  unauthorized access. Encrypting the file or set of files will protect the user data even
                  when low-level tools that bypass operating system protections such as discretionary and
                  mandatory access controls are available to an attacker. Users that are authorized to
                  access the data must provide authorization factors to the TOE in order for the data to
                  be decrypted and provided to the user.<br xmlns=""> [FCS_CKM_EXT.1, FDP_PRT_EXT.1, FMT_SMF.1,
                  FCS_COP.1(1) (optional: FDP_AUT_EXT.2, FDP_AUT_EXT.3) (selectable: FCS_KM_EXT.1,
                  FCS_COP.1(4), FCS_CKM.1(A))] 
               </description>
               
               <component-refer ref="INSERT REQ"></component-refer>
               
            </SO>
            
            <SO id="O.SAFE_AUTHFACTOR_VERIFICATION">
               
               <description>
                  <b xmlns="">Safe Authentication Factor Verification:</b> In order to avoid exposing information
                  that would allow an attacker to compromise or weaken any factors in the chain keys
                  generated or protected by the authorization factors, the TOE will verify the valid
                  authorization factor prior to the FEK being used to decrypt the data being
                  protected.<br xmlns=""> [FIA_AUT_EXT.1 (selectable: FIA_FCT_EXT.1(1), FIA_FCT_EXT.1(2))]
                  
               </description>
               
               <component-refer ref="INSERT REQ"></component-refer>
               
            </SO>
            
            <SO id="O.DATA_AUTHENTICATION">
               
               <description>
                  <b xmlns="">Data Authentication:</b> For certain encryption modes, it is feasible to maliciously
                  modify the ciphertext data to cause unintended modifications to plaintext data, without
                  user notification. The TOE may provide a method for authenticating the sensitive data
                  and using an approved data authentication method.<br xmlns=""> [FCS_CKM_EXT.4 (optional:
                  FDP_AUT_EXT.1, FDP_AUT_EXT.2, FDP_AUT_EXT.3, , FCS_CKM_EXT.5)] 
               </description>
               
               <component-refer ref="INSERT REQ"></component-refer>
               
            </SO>
            
            <SO id="O.CORRECT_TSF_OPERATION">
               
               <description>The TOE will provide the capability to test the TSF to ensure the correct
                  operation of the TSF in its operational environment.
               </description>
               
               <component-refer ref="INSERT REQ"></component-refer>
               
            </SO>
            
            <SO id="O.MANAGE">
               
               <description>The TOE will provide all the functions and facilities necessary to support
                  the authorized administrators in their management of the security of the TOE, and
                  restrict these functions and facilities from unauthorized use.
               </description>
               
               <component-refer ref="INSERT REQ"></component-refer>
               
            </SO>
            
         </SOs>
         
      </section>
      
      <section title="Security Objectives for the TOE's Operational Environment" id="objenv"> The
         Operational Environment of the TOE implements technical and procedural measures to assist the
         TOE in correctly providing its security functionality (which is defined by the security
         objectives for the TOE). The security objectives for the Operational Environment consist of a
         set of statements describing the goals that the Operational Environment should achieve.<br xmlns="">
         This section defines the security objectives that are to be addressed by the IT domain or by
         non-technical or procedural means. The assumptions identified in Section 3 are incorporated as
         security objectives for the environment. 
         <SOs>
            
            <SO id="OE.AUTHORIZATION_FACTOR_STRENGTH">
               
               <description>An authorized user will be responsible for ensuring that all externally
                  derived authorization factors have sufficient strength and entropy to reflect the
                  sensitivity of the data being protected. This can apply to password- or
                  passphrase-based, ECC CDH, and RSA authorization factors.
               </description>
               
               <component-refer ref="INSERT REQ"></component-refer>
               
            </SO>
            
            <SO id="OE.POWER_SAVE">
               
               <description>The non-mobile operational environment must be configurable so that there
                  exists at least one mechanism that will cause the system to power down after a period of
                  time in the same fashion as the user electing to shutdown the system (A.SHUTDOWN). Any
                  such mechanism (e.g., sleep, hibernate) that does not conform to this requirement must
                  be capable of being disabled. <br xmlns=""> The mobile operational environment must be
                  configurable such that there exists at least one mechanism that will cause the system to
                  lock upon a period of time. 
               </description>
               
               <component-refer ref="INSERT REQ"></component-refer>
               
            </SO>
            
            <SO id="OE.STRONG_ENVIRONMENT_CRYPTO">
               
               <description>The Operating environment will provide a cryptographic function capability
                  that is commensurate with the requirements and capabilities of the TOE.
               </description>
               
               <component-refer ref="INSERT REQ"></component-refer>
               
            </SO>
            
            <SO id="OE.TRAINED_USERS">
               
               <description>Authorized users of the host machine will be trained to follow all provided
                  guidance.
               </description>
               
               <component-refer ref="INSERT REQ"></component-refer>
               
            </SO>
            
         </SOs>
         
      </section>
      
      <section title="Security Objectives Rationale" id="SOR">This section describes how the
         assumptions, threats, and organizational security policies map to the security objectives.
         
         <insertSPDCorrespondence xmlns=""></insertSPDCorrespondence>
         
      </section>
      
   </chapter>
   
   
   <chapter title="Security Requirements" id="req">This chapter describes the security requirements
      which have to be fulfilled by the email client. Those requirements comprise functional
      components from Part 2 of <cite linkend="bibCC"></cite>. The following notations are used: 
      <ul xmlns="">
         
         <li>
            <b>Selection</b> (denoted by <i>italicized text</i>): is used to select one or more options
            provided by the [CC] in stating a requirement.
         </li>
         
         <li>
            <b>Assignment</b> operation (denoted by <i>italicized text</i>): is used to assign a
            specific value to an unspecified parameter, such as the length of a password. Showing the
            value in square brackets indicates assignment.
         </li>
         
         <li>
            <b>Iteration</b> operation: are identified with a number inside parentheses (e.g.
            "(1)").
         </li>
         
      </ul>
      
      <section title="Security Functional Requirements for the File Encryption Application (TOE)" id="sfr1"> As indicated in Section 1.3.2, security functional requirements in the main body of
         the EP are divided into those that must be satisfied by the file encryption application (the
         TOE), and those that must be satisfied by either the TOE or the platform on which it runs.
         This section contains the requirements that must be met by the TOE. 
         
         
         <subsection title="Cryptographic Support (FCS)" id="fcs">
            
            <f-component id="FCS_CKM_EXT.2" name="Cryptographic key generation (FEK)">
               
               <f-element id="FCS_CKM_EXT.2.1">
                  
                  <title> The TSF shall 
                     
                     <selectables>
                        
                        <selectable>accept FEK from an enterprise management server</selectable>
                        
                        <selectable> generate FEK cryptographic keys <br xmlns="">
                           
                           <selectables linebreak="yes">
                              
                              <selectable> using a Random Bit Generator as specified in FCS_RBG_EXT.1 (from the AS
                                 PP) and with entropy corresponding to the security strength of AES key sizes of
                                 [selection: 128 bit, 256 bit]; 
                              </selectable>
                              
                              <selectable> derived from a password/passphrase that is conditioned as defined in FCS_CKM.1(A) </selectable>
                              
                           </selectables>
                           
                        </selectable>
                        
                     </selectables>
                     
                  </title>
                  
               </f-element>
               
               <f-element id="FCS_CKM_EXT.2.2">
                  
                  <title>The TSF shall create a unique FEK for each file (or set of files) using the
                     mechanism on the client as specified in FCS_CKM_EXT.2.1.
                  </title>
                  
               </f-element>
               
               <f-element id="FCS_CKM_EXT.2.3">
                  
                  <title>The FEKs must be generated or derived by the TOE or accepted from an enterprise management server.</title>
                  
                  <note role="application"> For the first selection, the TOE may accept FEKS from an file encryption enterprise managment server.
                     For the thrid selection, the key generation capability of the
                     TOE uses a RBG implemented on the TOE device (FCS_RBG_EXT.1 from the <cite linkend="bibAppPP"></cite>). Either 128-bit or 256-bit (or both) are allowed for the FEK;
                     the ST author makes the selection appropriate for the device. For the fourth
                     selection, the key is derived from the conditioning of a password/passphrase.<br xmlns="">
                     
                  </note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4> FCS_CKM_EXT.2.1: The evaluator shall review the TSS to determine that a
                     description covering how and when a FEK are generated exists. The description must
                     cover all environments on which the TOE is claiming conformance, and include any
                     preconditions that must exist in order to successfully generate the FEK. The TSS is
                     checked to ensure that the description of how the FEK are generated is consistent with
                     the instructions in the AGD guidance, and any differences that arise from different
                     platforms are taken into account. This assurance activity may be combined with
                     activities for FCS_COP.1(5) and FCS_CKM_EXT.2.1. <br xmlns=""> For the third selection, the
                     evaluator shall review the TSS to determine that it describes how the functionality
                     described by FCS_RBG_EXT.1 (from the <cite linkend="bibAppPP"></cite>) is invoked to
                     generate FEK. To the extent possible from the description of the RBG functionality in
                     FCS_RBG_EXT.1 (from the AS PP), the evaluator shall determine that the key size being
                     requested is identical to the key size and mode to be used for the
                     decryption/encryption of the user data (FCS_COP.1(1)). <br xmlns=""> For the fourth selection,
                     password/passphrase-based factors, the examination of the TSS section is performed as
                     part of FCS_CKM.1(A) assurance activities. <br xmlns=""> 
                     FCS_CKM_EXT.2.2: The evaluator shall
                     examine the TSS to determine that it describes how a FEK is created for a protected
                     resource and associated with that resource; protection of the FEK itself is covered by
                     FIA_AUT_EXT.1 and FCS_COP.1(5). The evaluator confirms that&#8212;per this description&#8212;the
                     FEK is unique per resource (file or set of files) and that the FEK is created using
                     the mechanisms specified in ). <br xmlns=""> FCS_CKM_EXT.2.3: The evaluator shall review the
                     TSS to verify it details that the FEKs are generated on the client machine or accepted from an
                     external server. 
                     <h4 xmlns="">Guidance</h4> The evaluator shall review the
                     instructions in the AGD guidance to determine that any explicit actions that need to
                     be taken by the user to create a FEK exist&#8212;taking into account any differences that
                     arise from different platforms&#8212;and are consistent with the description in the TSS.
                     
                     <h4 xmlns="">Tests</h4> None. 
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
            <f-component id="FCS_CKM_EXT.4" name="Extended: Cryptographic Key Destruction">
               
               <f-element id="FCS_CKM_EXT.4.1">
                  
                  <title>The TSF shall destroy cryptographic keys in accordance with a specified cryptographic key destruction method 
                     
                     <selectables linebreak="yes">
                        
                        <selectable> For volatile memory, the destruction shall be executed by a
                           
                           <selectables>
                              
                              <selectable>single overwrite consitting of 
                                 
                                 <selectables>
                                    
                                    <selectable>a pseudo-random pattern using the TSF's RBG</selectable>
                                    
                                    <selectable>zeros</selectable>
                                    
                                    <selectable>ones</selectable>
                                    
                                    <selectable>new value of a key</selectable>
                                    
                                    <selectable>
                                       <assignable>any value that does not contain any CSP</assignable>
                                    </selectable>
                                    
                                 </selectables>
                                 
                              </selectable>
                              
                              <selectable>removal of power to the memory</selectable>
                              
                              <selectable>destruction of reference to the key directly followed by a request for garbage collection</selectable>
                              
                           </selectables>
                           
                        </selectable>
                        
                        <selectable> For non-volatile memory that consists of the invocation of an interface provided by the underlying platform that
                           
                           <selectables>
                              
                              <selectable>logically addresses the storage locatoin of the key and performs a
                                 
                                 <selectables>
                                    
                                    <selectable>single</selectable>
                                    
                                    <selectable>
                                       <assignable>ST author defined multi-pass</assignable>
                                    </selectable>
                                    
                                 </selectables>
                                 overwrite consisting of 
                                 
                                 <selectables>
                                    
                                    <selectable>a pseudo-random pattern using the TSF's RBG</selectable>
                                    
                                    <selectable>zeros</selectable>
                                    
                                    <selectable>ones</selectable>
                                    
                                    <selectable>new value of a key</selectable>
                                    
                                    <selectable>
                                       <assignable>any value that does not contain any CSP</assignable>
                                    </selectable>
                                    
                                 </selectables>
                                 
                              </selectable>
                              
                              <selectable>instructs the underlying platform to destory the abstraction the represents the key</selectable>
                              
                           </selectables>
                           
                           
                        </selectable>
                        
                     </selectables>
                     
                  </title>
                  
                  <note role="application"> The interface referenced in the requirement could take different forms, 
                     the most likely of which is an application programming interface to an OS kernel. There may be 
                     various levels of abstraction visible. For instance, in a given implementation, selection a, the 
                     application may have access to the file system details and may be able to logically address 
                     specific memory locations. In another implementation, selection b, the application may simply 
                     have a handle to a resource and can only ask the platform to delete the resource, as may be the 
                     case with a platforms secure key store. Selection b should only be used for the most restricted access. 
                     The level of detail to which the TOE has access will be reflected in the TSS section of the ST.
                     
                     
                     
                     Several selections allow assignment of a &#8216;value that does not contain any CSP&#8217;. This means that 
                     the TOE uses some other specified data not drawn from a source that may contain key material or 
                     reveal information about key material, and not being any of the particular values listed as other 
                     selection options. The point of the phrase &#8216;does not contain any CSP&#8217; is to ensure that the 
                     overwritten data is carefully selected, and not taken from a general &#8216;pool&#8217; that might contain 
                     current or residual data that itself requires confidentiality protection. 
                  </note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4> The evaluator examines the TSS to ensure it describes how the keys are managed in volatile memory. 
                     This description includes details of how each identified key is introduced into volatile memory (e.g. by derivation 
                     from user input, or by unwrapping a wrapped key stored in non-volatile memory) and how they are overwritten.
                     
                     The evaluator shall check to ensure the TSS lists each type of key that is stored in in non-volatile memory, and 
                     identifies how the TOE interacts with the underlying platform to manage keys (e.g., store, retrieve, destroy). 
                     The description includes details on the method of how the TOE interacts with the platform, including an identification 
                     and description of the interfaces it uses to manage keys (e.g., file system APIs, platform key store APIs).
                     
                     The evaluator examines the interface description for each different media type to ensure that the 
                     interface supports the selection(s) and description in the TSS.
                     
                     If the ST makes use of the open assignment and fills in the type of pattern that is used, the evaluator 
                     examines the TSS to ensure it describes how that pattern is obtained and used. The evaluator shall 
                     verify that the pattern does not contain any CSPs.
                     
                     The evaluator shall check that the TSS identifies any configurations or 
                     circumstances that may not strictly conform to the key destruction requirement.
                     
                     
                     <h4 xmlns="">Guidance</h4> There are a variety of concerns that may prevent or delay key destruction in some cases.
                     
                     The evaluator shall check that the guidance documentation identifies configurations or circumstances that may 
                     not strictly conform to the key destruction requirement, and that this description is consistent with the 
                     relevant parts of the TSS and any other relevant Required Supplementary Information.
                     
                     The evaluator shall check that the guidance documentation provides guidance on situations where key 
                     destruction may be delayed at the physical layer and how such situations can be avoided or mitigated if possible.
                     
                     Some examples of what is expected to be in the documentation are provided here. 
                     
                     When the TOE does not have full access to the physical memory, it is possible that the storage may be implementing 
                     wear-leveling and garbage collection. This may create additional copies of the key that are logically inaccessible 
                     but persist physically. In this case, to mitigate this the drive should support the TRIM command and implements 
                     garbage collection to destroy these persistent copies when not actively engaged in other tasks.
                     
                     Drive vendors implement garbage collection in a variety of different ways, as such there is a variable amount of time 
                     until data is truly removed from these solutions. There is a risk that data may persist for a longer amount of time 
                     if it is contained in a block with other data not ready for erasure. To reduce this risk, the operating system and 
                     file system of the OE should support TRIM, instructing the non-volatile memory to erase copies via garbage collection 
                     upon their deletion. If a RAID array is being used, only set-ups that support TRIM are utilized. If the drive is 
                     connected via PCI-Express, the operating system supports TRIM over that channel.
                     
                     The drive should be healthy and contains minimal corrupted data and should be end of lifed before a significant 
                     amount of damage to drive health occurs, this minimizes the risk that small amounts of 
                     potentially recoverable data may remain in damaged areas of the drive.
                     
                     
                     <h4 xmlns="">Tests</h4> 
                     These tests are only for key destruction provided by the application, test 2 does not apply to any keys using the selection
                     "new value of a key": 
                     
                     <testlist>
                        
                        <test>Test 1: Applied to each key held as in volatile memory and subject to destruction by overwrite by the 
                           TOE (whether or not the value is subsequently encrypted for storage in volatile or non-volatile memory). 
                           In the case where the only selection made for the destruction method key was removal of power, then this test is unnecessary.
                           
                           
                           The evaluator shall:
                           
                           Record the value of the key in the TOE subject to clearing.
                           
                           Cause the TOE to perform a normal cryptographic processing with the key from Step #1.
                           
                           Cause the TOE to clear the key.
                           
                           Cause the TOE to stop the execution but not exit.
                           
                           Cause the TOE to dump the entire memory of the TOE into a binary file.
                           
                           Search the content of the binary file created in Step #5 for instances of the known key value from Step #1.
                           
                           Steps 1-6 ensure that the complete key does not exist anywhere in volatile memory. If a copy is found, then the test fails.
                        </test>
                        
                        
                        <test>Test 2:  Applied to each key help in non-volatile memory and subject to destruction by the TOE. 
                           The evaluator shall use special tools (as needed), provided by the TOE developer if necessary, to ensure the tests function
                           as intended.
                           
                           Identify the purpose of the key and what access should fail when it is deleted. (e.g. the data encryption key being deleted
                           would cause data decryption to fail.)
                           
                           Cause the TOE to clear the key.
                           
                           Have the TOE attempt the functionality that the cleared key would be necessary for.
                           
                           The test succeeds if step 3 fails.
                           
                           The following tests apply only to selection a), since the TOE in this instance has more visibility into what is happening
                           within the underlying platform (e.g., a logical view of the media). In selection b), the TOE has no visibility into the inner
                           workings and completely relies on the underlying platform, so there is no reason to test the TOE beyond test 1.
                           
                           For selection a), the following tests are used to determine the TOE is able to request the platform to overwrite the key with
                           a TOE supplied pattern.
                        </test>
                        
                        
                        <test>Test 3:Applied to each key held in non-volatile memory and subject to destruction by overwrite by the TOE. The evaluator shall
                           use a tool that provides a logical view of the media (e.g., MBR file system):
                           
                           Record the value of the key in the TOE subject to clearing.
                           
                           Cause the TOE to perform a normal cryptographic processing with the key from Step #1.
                           
                           Cause the TOE to clear the key.
                           
                           Search the logical view that the key was stored in for instances of the known key value from Step #1. If a copy is found,
                           then the test fails.
                           
                           Test 4: Applied to each key held as non-volatile memory and subject to destruction by overwrite by the TOE. The evaluator
                           shall use a tool that provides a logical view of the media:
                           
                           Record the logical storage location of the key in the TOE subject to clearing.
                           
                           Cause the TOE to perform a normal cryptographic processing with the key from Step #1.
                           
                           Cause the TOE to clear the key.
                           
                           Read the logical storage location in Step #1 of non-volatile memory to ensure the appropriate pattern is utilized.
                           
                           The test succeeds if correct pattern is used to overwrite the key in the memory location. If the pattern is not found the
                           test fails.
                        </test>
                        
                     </testlist>
                     
                  </aactivity>
                  
               </f-element>
               
               <f-element id="FCS_CKM_EXT.4.1(a)">
                  
                  <title>The TSF shall destroy all keys and key material when no longer needed.</title>
                  
                  
                  <note role="application">Application Note: Keys, including intermediate keys and key material that are no longer
                     needed are destroyed by using an approved method, FCS_CKM_EXT.4.1. Examples of keys are
                     intermediate keys, submasks. There may be instances where keys or key material
                     that are contained in persistent storage are no longer needed and require destruction. 
                     Base on their implementation, vendors will explain when certain keys are no longer needed. There
                     are multiple situations in which key material is no longer necessary, for example, a wrapped
                     key may need to be destroyed when a password is changed. However, there are instances
                     when keys are allowed to remain in memory, for example, a device identification key. If a
                     PIN was used for a SmartCard, ensuring that the PIN was properly destroyed shall be addressed.
                     
                  </note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4>              
                     The evaluator shall verify the TSS includes a description of the areas where keys
                     and key material reside and when the keys and key material are no longer needed.
                     The evaluator shall verify the KMD includes a key lifecycle, that includes a
                     description where key material reside, how the key material is used, how it is
                     determined that keys and key material are no longer needed, and how the material is
                     destroyed once it is not needed and that the documentation in the follows
                     FCS_CKM_EXT.4.1 for the destruction.
                     
                     
                     
                     <h4 xmlns="">Guidance</h4> None.
                     
                     
                     <h4 xmlns="">Tests</h4> None.
                     
                     
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
            <f-component id="FCS_COP.1(1)" name="Cryptographic operation (Data Encryption)">
               
               <f-element id="FCS_COP.1.1(1)">
                  
                  <title>
                     <b xmlns="">Refinement:</b> The application shall 
                     <selectables>
                        
                        <selectable>implement platform-provided AES encryption</selectable>
                        
                        <selectable>implement AES encryption</selectable>
                        
                     </selectables> shall perform <b xmlns="">data encryption and decryption</b> in accordance with
                     a specified cryptographic algorithm <b xmlns="">AES used in</b>
                     
                     <selectables linebreak="yes">
                        
                        <selectable> CBC (as defined in NIST SP 800-38A)</selectable>
                        
                        <selectable> GCM (as defined in NIST SP 800-38D)</selectable>
                        
                        <selectable> XTS (as defined in NIST SP 800-38E)</selectable>
                        
                     </selectables>
                     <b xmlns="">mode</b> and cryptographic key sizes 
                     <selectables linebreak="yes">
                        
                        <selectable>128 bits;</selectable>
                        
                        <selectable>256 bits</selectable>
                        
                     </selectables>
                     
                  </title>
                  
                  <note role="application"> The intent of this requirement is to specify the approved AES
                     modes that the ST author may select for AES encryption of the appropriate information
                     on the file encryption software. The first selection indicates whether the TOE or the
                     platform performs the actual cryptographic operations. For the second selection, the
                     ST author should indicate the mode or modes supported by the TOE/platform
                     implementation. The third selection indicates the key size to be used, which is
                     identical to that specified for FCS_CKM_EXT.1. The fourth selection must agree with
                     the mode or modes chosen in the first selection. If multiple modes are supported, it
                     may be clearer in the ST if this component was iterated. <br xmlns=""> The CBC encryption mode
                     may also be used to encrypt sets of files and must follow NIST SP 800-38 A to use
                     unique IVs for each file that is encrypted. <br xmlns=""> 
                     
                     When the XTS mode is selected, a cryptographic key of 256-bit or of 512-bit is allowed as
                     specified in IEEE 1619. XTS-AES key is divided into two AES keys of equal size - for
                     example, AES-128 is used as the underlying algorithm, when 256-bit key and XTS mode are
                     selected. AES-256 is used when a 512-bit key and XTS mode are selected.
                     
                     
                  </note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4>
                     
                     <h4 xmlns="">Requirement met by the platform</h4> The evaluator examines the TSS to determine that it lists 
                     the APIs used by the TOE to invoke the required functionality on the platform. The evaluator examines 
                     the ST of all platforms claimed in the TOE ST to determine that the specific modes and key-sizes are 
                     supported by the underlying platform, and that the APIs listed in the TSS section are those that were exercised on each underlying
                     platform<br xmlns="">
                     
                     <h4 xmlns="">Requirement met by the TOE</h4> If multiple modes are supported, the evaluator 
                     examines the TSS to determine how a specific mode/key-size is chosen by the end user. <br xmlns="">
                     
                     <h4 xmlns="">Guidance</h4> 
                     
                     <h4 xmlns="">Requirement met by the platform</h4>  If multiple modes are supported, the evaluator examines the Operational Guidance to 
                     determine how a specific mode/key-size is chosen by the end user. 
                     
                     <h4 xmlns="">Tests</h4> 
                     <h4 xmlns="">Requirement met by the TOE</h4> 
                     The assurance activity tests specified for AES in GCM mode in the underlying Application Software PP shall be performed in
                     the case that "GCM" is selected in the requirement.
                     
                     <h4 xmlns="">AES-CBC Tests</h4>
                     
                     <h4 xmlns="">AES-CBC Known Answer Tests </h4> There are four Known Answer Tests (KATs),
                     described below. In all KATs, the plaintext, ciphertext, and IV values shall be
                     128-bit blocks. The results from each test may either be obtained by the evaluator
                     directly or by supplying the inputs to the implementer and receiving the results in
                     response. To determine correctness, the evaluator shall compare the resulting values
                     to those obtained by submitting the same inputs to a known good implementation.
                     
                     <h4 xmlns="">KAT-1.</h4> To test the encrypt functionality of AES-CBC, the evaluator shall
                     supply a set of 10 plaintext values and obtain the ciphertext value that results from
                     AES-CBC encryption of the given plaintext using a key value of all zeros and an IV of
                     all zeros. Five plaintext values shall be encrypted with a 128-bit all-zeros key, and
                     the other five shall be encrypted with a 256-bit all-zeros key. <br xmlns="">To test the
                     decrypt functionality of AES-CBC, the evaluator shall perform the same test as for
                     encrypt, using 10 ciphertext values as input and AES-CBC decryption. 
                     <h4 xmlns="">KAT-2.</h4>
                     To test the encrypt functionality of AES-CBC, the evaluator shall supply a set of 10
                     key values and obtain the ciphertext value that results from AES-CBC encryption of an
                     all-zeros plaintext using the given key value and an IV of all zeros. Five of the keys
                     shall be 128-bit keys, and the other five shall be 256-bit keys. <br xmlns="">To test the
                     decrypt functionality of AES-CBC, the evaluator shall perform the same test as for
                     encrypt, using an all-zero ciphertext value as input and AES-CBC decryption.
                     
                     <h4 xmlns="">KAT-3.</h4> To test the encrypt functionality of AES-CBC, the evaluator shall
                     supply the two sets of key values described below and obtain the ciphertext value that
                     results from AES encryption of an all-zeros plaintext using the given key value and an
                     IV of all zeros. The first set of keys shall have 128 128-bit keys, and the second set
                     shall have 256 256-bit keys. Key i in each set shall have the leftmost i bits be ones
                     and the rightmost N-i bits be zeros, for i in [1,N]. <br xmlns="">To test the decrypt
                     functionality of AES-CBC, the evaluator shall supply the two sets of key and
                     ciphertext value pairs described below and obtain the plaintext value that results
                     from AES-CBC decryption of the given ciphertext using the given key and an IV of all
                     zeros. The first set of key/ciphertext pairs shall have 128 128-bit key/ciphertext
                     pairs, and the second set of key/ciphertext pairs shall have 256 256-bit
                     key/ciphertext pairs. Key i in each set shall have the leftmost i bits be ones and the
                     rightmost N-i bits be zeros, for i in [1,N]. The ciphertext value in each pair shall
                     be the value that results in an all-zeros plaintext when decrypted with its
                     corresponding key. 
                     <h4 xmlns="">KAT-4.</h4> To test the encrypt functionality of AES-CBC, the
                     evaluator shall supply the set of 128 plaintext values described below and obtain the
                     two ciphertext values that result from AES-CBC encryption of the given plaintext using
                     a 128-bit key value of all zeros with an IV of all zeros and using a 256-bit key value
                     of all zeros with an IV of all zeros, respectively. Plaintext value i in each set
                     shall have the leftmost i bits be ones and the rightmost 128-i bits be zeros, for i in
                     [1,128]. <br xmlns=""> To test the decrypt functionality of AES-CBC, the evaluator shall
                     perform the same test as for encrypt, using ciphertext values of the same form as the
                     plaintext in the encrypt test as input and AES-CBC decryption. <br xmlns="">
                     
                     <h4 xmlns="">AES-CBC Multi-Block Message Test</h4> The evaluator shall test the encrypt
                     functionality by encrypting an i-block message where 1 &lt; i &lt;=10. The evaluator
                     shall choose a key, an IV and plaintext message of length i blocks and encrypt the
                     message, using the mode to be tested, with the chosen key and IV. The ciphertext shall
                     be compared to the result of encrypting the same plaintext message with the same key
                     and IV using a known good implementation. <br xmlns=""> The evaluator shall also test the
                     decrypt functionality for each mode by decrypting an i-block message where 1 &lt; i
                     &lt;=10. The evaluator shall choose a key, an IV and a ciphertext message of length i
                     blocks and decrypt the message, using the mode to be tested, with the chosen key and
                     IV. The plaintext shall be compared to the result of decrypting the same ciphertext
                     message with the same key and IV using a known good implementation. <br xmlns="">
                     
                     <h4 xmlns="">AES-CBC Monte Carlo Tests</h4> The evaluator shall test the encrypt functionality
                     using a set of 200 plaintext, IV, and key 3-tuples. 100 of these shall use 128 bit
                     keys, and 100 shall use 256 bit keys. The plaintext and IV values shall be 128-bit
                     blocks. For each 3-tuple, 1000 iterations shall be run as follows:
                     <pre xmlns="">
                # Input: PT, IV, Key <br>
                for i = 1 to 1000: <br>
                  if i == 1: <br>
                    CT[1] = AES-CBC-Encrypt(Key, IV, PT)<br> 
                    PT = IV <br>
                  else: <br>
                    CT[i] = AES-CBC-Encrypt(Key, PT) <br>
                    PT = CT[i-1] <br>
              </pre>
                     The ciphertext computed in the 1000th iteration (i.e., CT[1000]) is the result for
                     that trial. This result shall be compared to the result of running 1000 iterations
                     with the same values using a known good implementation. <br xmlns="">The evaluator shall test
                     the decrypt functionality using the same test as for encrypt, exchanging CT and PT and
                     replacing AES-CBC-Encrypt with AES-CBC-Decrypt. 
                     
                     <h4 xmlns="">XTS-AES Monte Carlo Test</h4> The
                     evaluator shall test the encrypt functionality of XTS-AES for each combination of the
                     following input parameter lengths: 
                     <h4 xmlns="">256 bit (for AES-128) and 512 bit (for AES-256)
                        keys
                     </h4>
                     
                     <h4 xmlns="">Three data unit (i.e., plaintext) lengths.</h4> One of the data unit lengths shall
                     be a non-zero integer multiple of 128 bits, if supported. One of the data unit lengths
                     shall be an integer multiple of 128 bits, if supported. The third data unit length
                     shall be either the longest supported data unit length or 216 bits, whichever is
                     smaller. <br xmlns=""> using a set of 100 (key, plaintext and 128-bit random tweak value)
                     3-tuples and obtain the ciphertext that results from XTS-AES encrypt. <br xmlns=""> The
                     evaluator may supply a data unit sequence number instead of the tweak value if the
                     implementation supports it. The data unit sequence number is a base-10 number ranging
                     between 0 and 255 that implementations convert to a tweak value internally. <br xmlns=""> The
                     evaluator shall test the decrypt functionality of XTS-AES using the same test as for
                     encrypt, replacing plaintext values with ciphertext values and XTS-AES encrypt with
                     XTS-AES decrypt. 
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
            <f-component id="FCS_COP.1(5)" name="Cryptographic operation (Key Wrapping)" status="sel-based">
               
               <selection-depends req="XXX_XXX.1.1" ids="INSERT"></selection-depends>
               
               <f-element id="FCS_COP.1.1(5)">
                  
                  <title>
                     <b xmlns="">Refinement:</b> The application shall 
                     
                     <selectables>
                        
                        <selectable>use platform-provided functionality to perform Key Wrapping</selectable>
                        
                        <selectable>implement functionality to perform Key Wrapping</selectable>
                        
                     </selectables> in accordance with a specified cryptographic algorithm [AES] in the following modes
                     
                     <selectables linebreak="yes">
                        
                        <selectable>Key Wrap</selectable>
                        
                        <selectable>Key Wrap with Padding</selectable>
                        
                        <selectable>GMC mode</selectable>
                        
                        <selectable>CCM mode</selectable>
                        
                     </selectables> and the cryptographic key size 
                     
                     <selectables>
                        
                        <selectable>128 bits (AES)</selectable>
                        
                        <selectable>256 bits (AES)</selectable>
                        
                     </selectables> that meet the following: 
                     
                     <selectables linebreak="yes">
                        
                        <selectable>&#8220;NIST SP 800-38C&#8221;</selectable>
                        
                        <selectable>&#8220;NIST SP 800-38D&#8221;</selectable>
                        
                        <selectable>&#8220;NIST SP 800-38F&#8221;</selectable>
                        
                        <selectable>no other standards</selectable>
                        
                     </selectables>
                     
                  </title>
                  
                  <note role="application">None.</note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4>
                     
                     <h4 xmlns="">Requirement met by the platform</h4> If the platform provides the FEK
                     encryption/decryption, then the evaluator shall examine the TSS to verify that it
                     describes how the FEK encryption/decryption is invoked. <br xmlns="">
                     
                     <h4 xmlns="">Requirement met by the TOE</h4> The evaluator shall verify the TSS includes a description of the key wrap function(s)
                     and shall verify the key wrap uses an approved key wrap algorithm according to the
                     appropriate specification. <br xmlns="">
                     
                     <h4 xmlns="">Guidance</h4> None. 
                     
                     <h4 xmlns="">Tests</h4> These tests are only for data encryption provided by the application: 
                     
                     <testlist>
                        
                        <test>The evaluator shall use platform tools (such as a debugger) to generate a FEK
                           to be generated and capture the value of the FEK. The evaluator shall then
                           continue with the TOE operation which will result in an encrypted resource, as
                           well as an encrypted FEK being associated with the resource as described in the
                           TSS. The evaluator shall then examine the encrypted FEK to determine that it is
                           different than the value of the unencrypted FEK. The evaluator shall then use the
                           information provided in the ST and TSS to determine that the unencrypted FEK&#8212;when
                           wrapped according to the algorithm and parameters used by the TOE as
                           described&#8212;produces the value observed for the encrypted FEK.
                        </test>
                        
                     </testlist>
                     
                     <h4 xmlns="">
                        The assurance activity tests specified for AES in GCM mode in the underlying 
                        Application Software PP shall be performed in the case that "GCM" is selected in the requirement.
                        AES Key Wrap (with or without padding)
                     </h4> If AES Key Wrap is used to
                     decrypt/encrypt the key, the evaluator shall examine the TSS to determine that it
                     specifies that the implementation conforms to SP 800-38F with the appropriate (with or
                     without padding) Key Wrap section using AES. <br xmlns=""> The evaluator shall also perform
                     the verification procedures outlined in the testing methodology, &#8220;The Key Wrap
                     Validation System&#8221;. (http://csrc.nist.gov/groups/STM/cavp/documents/mac/KWVS.pdf) 
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
            <f-component id="FCS_IV_EXT.1" name="Extended: Initialization Vector Generation">
               
               <f-element id="FCS_IV_EXT.1.1 ">
                  
                  <title>The application shall 
                     <selectables>
                        
                        <selectable>implement platform-provided functionality to generate IVs</selectable>
                        
                        <selectable>generate IVs</selectable>
                        
                     </selectables> in accordance with Appendix H: Initialization Vector Requirements for
                     NIST-Approved Cipher Modes.
                  </title>
                  
                  <note role="application">Appendix G lists the requirements for composition of IVs
                     according to the NIST Special Publications for each cipher mode. The composition of
                     IVs generated for encryption according to a cryptographic protocol is addressed by the
                     protocol. Thus, this requirement addresses only IVs generated for key storage and data
                     storage encryption.
                  </note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4>
                     
                     <h4 xmlns="">Requirement met by the platform</h4> If the platform provides the IV generation,
                     then the evaluator shall examine the TSS to verify that it describes how the IV
                     generation is invoked. <br xmlns="">
                     
                     <h4 xmlns="">Requirement met by the TOE</h4> The evaluator shall examine the key hierarchy
                     section of the TSS to ensure that the encryption of all keys is described and the
                     formation of the IVs for any data encrypted by the same key meets FCS_IV_EXT.1.
                     
                     <h4 xmlns="">Guidance</h4>None. 
                     <h4 xmlns="">Tests</h4>None. 
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
            <f-component id="FCS_KYC_EXT.1" name="Key Chaining and Key Storage">
               
               <f-element id="FCS_KYC_EXT.1.1">
                  
                  <title> The TSF shall maintain a key chain of: 
                     
                     <selectables linebreak="yes">
                        
                        <selectable>a conditioned password as the FEK; </selectable>
                        
                        <selectable>KEKs originating from one or more authorization factors(s) to the FEK(s)
                           using the following method(s): 
                           
                           <selectables linebreak="yes">
                              
                              <selectable>utilization of the platform key storage</selectable>
                              
                              <selectable>utilization of platform key storage that performs key wrap with a
                                 TSF provided key
                              </selectable>
                              
                              <selectable>implement key wrapping as specified in FCS_COP.1(5)</selectable>
                              
                              <selectable>implement key combining as specified in FCS_SMC_EXT.1</selectable>
                              
                              <selectable>implement key encryption as specified in FCS_COP.1(1)</selectable>
                              
                           </selectables> while maintaining an effective strength of 
                           
                           <selectables>
                              
                              <selectable>
                                 
                                 <selectables>
                                    
                                    <selectable>128 bits</selectable>
                                    
                                    <selectable>256 bits</selectable>
                                    
                                 </selectables> for symmetric keys;
                                 
                              </selectable>
                              
                              <selectable>
                                 
                                 <selectables>
                                    
                                    <selectable>112 bits</selectable>
                                    
                                    <selectable>128 bits</selectable>
                                    
                                    <selectable>192 bits</selectable>
                                    
                                    <selectable>256 bits</selectable>
                                    
                                 </selectables> for asymmetric keys;
                                 
                              </selectable>
                              
                           </selectables> commensurate with the strength of the FEK
                           
                        </selectable>
                        
                     </selectables> 
                     and 
                     
                     <selectables>
                        
                        <selectable> no supplemental key chains</selectable>
                        
                        <selectable> other supplemental key chains that protect a key or keys in the primary key chain using the folliwing method(s):
                           
                           <selectables linebreak="yes">
                              
                              <selectable>utilization of the platform key storage</selectable>
                              
                              <selectable>utilization of platform key storage that performs key wrap with a
                                 TSF provided key
                              </selectable>
                              
                              <selectable>implement key wrapping as specified in FCS_COP.1(5)</selectable>
                              
                              <selectable>implement key combining as specified in FCS_SMC_EXT.1</selectable>
                              
                              <selectable>implement key encryption as specified in FCS_COP.1(1)</selectable>
                              
                           </selectables>
                        </selectable>
                        
                     </selectables>
                     
                  </title>
                  
                  <note role="application">Key Chaining is the method of using multiple layers of
                     encryption keys to ultimately secure the FEK. The number of intermediate keys will
                     vary. This applies to all keys that contribute to the ultimate wrapping or derivation
                     of the FEK; including those in areas of protected. For the first selection, the ST author
                     selects the method used for the keychain.  If the second option is chosen (&#8220;KEKs originating&#8230;&#8221;)
                     , then the ST author chooses all methods for production and protection of KEKs in the keychain 
                     from the options in the second selection.  For this option, the ST author must also specify the 
                     strength of the keys in the keychain.  It should be noted that &#8220;maintaining overall strength&#8230;
                     commensurate with the overall strength of the FEK&#8221; is meant to cover the use case for this EP 
                     of a powered-off device being recovered by an adversary, who subsequently attempts to recover 
                     the FEK through a compromise of the key chain. 
                     
                     The third selection in the requirement is used to select the types of keys used in the key chain 
                     (both symmetric and asymmetric keys are allowed).  The bit sizes selected in the fourth 
                     and fifth selections are chosen by the ST author to be commensurate with the strength of 
                     the FEK in the following manner: for symmetric FEKs of 128 bits, the ST author can select 
                     any of the choices for both symmetric and asymmetric keys.  For symmetric FEKs of 256 bits, 
                     the ST author selects 256 bits if the symmetric key option is chosen and 192 bits or 256 bits 
                     if the asymmetric key option is chosen.
                     
                     If a supplemental keychain is used, then the ST author selects the second option in the sixth 
                     selection and then chooses the method by which these keys are protected.  Keys in the 
                     supplemental key chain may be of any size, as they only provide additional protection to the 
                     primary key chain.  Compromise (according the EP use case) of the secondary key chain cannot 
                     circumvent the protection provided by the primary keychain. 
                  </note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4>
                     <b xmlns="">Requirement met by the TOE</b> The evaluator shall verify the TSS* contains a high level 
                     description of the key hierarchy for all keychains and authorization methods selected in FIA_AUT_EXT 
                     that are used to protect the KEK or FEK. The evaluator shall examine the TSS to ensure it describes 
                     each key chain in detail, and these descriptions correspond with the selections of the requirement. 
                     The description of each key chain shall be reviewed to ensure it maintains a chain of keys using key 
                     wrap that meet FCS_COP.1(5) if mandated by the selections in the requirement.
                     
                     
                     
                     The evaluator shall verify the TSS* to ensure that it describes how each key chain process functions, 
                     such that it does not expose any material that might compromise any key in the chain. A high-level 
                     description should include a diagram illustrating the key hierarchy implemented and detail where all 
                     keys and keying material is stored or what it is derived from. The evaluator shall examine the primary 
                     key hierarchy to ensure that at no point the chain could be broken without a cryptographic exhaust or 
                     knowledge of the KEK or FEK and the effective strength of the FEK is maintained throughout the Key Chain 
                     as specified in the requirement.
                     <h4 xmlns="">Guidance</h4>
                     None. 
                     <h4 xmlns="">Tests</h4>None. 
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
            <f-component id="FCS_CKM_EXT.5" name="File Authentication Key (FAK) Support" status="optional">
               
               <f-element id="FCS_CKM_EXT.5.1">
                  
                  <title> The TSF shall use a FAK to authenticate sensitive data when a cryptographic, keyed
                     hashing function is used for data authentication and shall be supported in the following
                     manner: 
                     <selectables linebreak="yes">
                        
                        <selectable>A FAK conditioned from a password/passphrase shall never be stored in
                           non-volatile memory
                        </selectable>
                        
                        <selectable>a FAK will be stored in non-volatile memory encrypted with a KEK as
                           specified in FCS_COP.1(5) using authorization factors as specified in FCS_CKM_EXT.1
                           
                        </selectable>
                        
                     </selectables>
                     
                  </title>
                  
               </f-element>
               
               <f-element id="FCS_CKM_EXT.5.2">
                  
                  <title>The TSF shall create a unique FAK for each file (or set of files) using the
                     mechanism on the client as specified in FCS_RBG_EXT.1.
                  </title>
                  
               </f-element>
               
               <f-element id="FCS_CKM_EXT.5.3">
                  
                  <title>The FAKs must be generated by the TOE.</title>
                  
               </f-element>
               
               <f-element id="FCS_CKM_EXT.5.4">
                  
                  <title>The TSF will not write FAKs to non-volatile memory.</title>
                  
               </f-element>
               
               <f-element id="FCS_CKM_EXT.5.5">
                  
                  <title>The FAK shall be protected in a manner conformant to FCS_COP.1(6).</title>
                  
                  <note role="application"> The intent of this requirement is to describe the different
                     methods that a FAK can be created and formed. <br xmlns="">FCS_CKM_EXT.5.1 details how a FAK may
                     be directly conditioned from a password/passphrase or may be a randomly generated from
                     an approved randomizer. <br xmlns="">FCS_CKM_EXT.5.2 requires that each resource to be encrypted
                     has a unique FAK, and that this FAK is generated by the TSF. If the encrypted resource
                     is a set of files encrypted under one FAK, additional requirements on the initialization
                     vectors and cipher modes must be adhered to in Section 4.2. 
                  </note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4> FCS_CKM_EXT.5.1: The evaluator shall examine the TSS to determine how the
                     FEK will actually be formed and details how the FEK is stored (or not stored) in memory.
                     <br xmlns=""> FCS_CKM_EXT.5.2: The evaluator shall examine the TSS to determine that it
                     describes how a FAK is created for a protected resource and associated with that
                     resource; protection of the FAK itself is covered by FCS_COP.1(5). The evaluator
                     confirms that&#8212;per this description&#8212;the FAK is unique per resource (file or set of files)
                     and that the FAK is created using the mechanisms specified in FCS_CKM_EXT.1. <br xmlns="">
                     FCS_CKM_EXT.5.3: The TSS must detail that the FAKs are generated on the client machine
                     and are not generated on an external server. <br xmlns=""> FCS_CKM_EXT.5.4: FCS_CKM_EXT.4
                     contains the requirements necessary to ensure that plaintext keys and key material do
                     not remain in plaintext form in the TSF&#8217;s non-volatile memory space. In TOEs where the
                     FAK is protected with a KEK, the FAK will need to be encrypted and stored in
                     non-volatile memory when not being used to decrypt/encrypt a file. (Typically, the
                     encrypted FAK is stored in the meta-data of the encrypted file(s).) The evaluator shall
                     examine the TSS to ensure that it describes how the FAK is encrypted, both after its
                     initial creation and after it has been decrypted for use (note that in the entirely
                     likely possibility that the FAK is not re-encrypted, then this case must be indicated in
                     the TSS and the description for FCS_CKM_EXT.4 will cover disposal of the plaintext FEK
                     and FAK). The evaluator shall further check to ensure that the TSS describes how the FAK
                     and any other associated meta-data necessary to decrypt the file or set of files are
                     associated with the resource. This description can be combined with the description
                     required for FCS_COP.1(5). <br xmlns="">
                     
                     <h4 xmlns="">Guidance</h4> None 
                     <h4 xmlns="">Tests</h4> An example ciphertext file generated via the TOE
                     shall be provided to the evaluator with the accompanying FAK and prerequisite
                     authorization information used for encryption. The evaluator will use the TOE in
                     conjunction with a debugging or forensics utility to attempt an authentication of the
                     ciphertext file using the provided authorization information. The evaluator will then
                     terminate processing of the TOE and perform a search through non-volatile memory using
                     the provided FAK string. The evaluator must document each command, program or action
                     taken during this process, and must confirm that the FAK was never written to
                     non-volatile memory. This test must be performed three times to ensure repeatability. If
                     during the course of this testing the evaluator finds that the FAK was written to
                     non-volatile memory, they should be able to identify the cause (i.e. the TOE wrote the
                     FAK to disk, the TOE platform dumped volatile memory as a page file, etc), and document
                     the reason for failure to comply with the requirement. 
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
            <f-component id="FCS_COP.1(6) " name="FAK encryption/decryption support" status="optional">
               
               <f-element id="FCS_COP.1.1(6)">
                  
                  <title>The FAK shall be protected in the same manner as the FEK, in accordance with
                     FCS_COP.1(5).
                  </title>
                  
                  <note role="application">53 The intent of this requirement is to clarify that, if a FAK is
                     to be used, it should be treated as sensitive as the FEK, and thus, follow the same
                     encryption and decryption practices. 
                  </note>
                  
                  <aactivity> The evaluator shall follow the assurance activities as laid out in
                     FCS_COP.1(5) to assert proper FAK protection. 
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
            <f-component id="FCS_CKM.1(A)" name="Extended: Cryptographic key generation (Password/Passphrase conditioning)" status="sel-based"> 
               
               <selection-depends req="fcs_ckm_ext.2.1" ids="qqqq"></selection-depends>
               
               <f-element id="FCS_CKM.1.1(A)">
                  
                  <title>
                     <b xmlns="">Refinement:</b>The TSF shall support a password/passphrase of up to 
                     [assignment: maximum password size, positive integer of 64 or more] 
                     characters used to generate a password authorization factor.characters in the
                     
                  </title>
                  
               </f-element>
               
               <f-element id="FCS_CKM.1.2(A)">
                  
                  <title>
                     <b xmlns="">Refinement:</b> The TSF shall allow passwords to be composed of any combination of upper case characters,
                     lower case characters, numbers, and the following special characters: &#8220;!&#8221;, &#8220;@&#8221;, &#8220;#&#8221;, &#8220;$&#8221;, &#8220;%&#8221;, &#8220;^&#8221;, &#8220;&amp;&#8221;, &#8220;*&#8221;, &#8220;(&#8220;, and &#8220;)&#8221;,
                     and [selection: [assignment: other supported special characters], no other characters].
                  </title>
                  
               </f-element>
               
               <f-element id="FCS_CKM.1.3(A)">
                  
                  <title>
                     <b xmlns="">Refinement:</b> The TSF shall perform [Password-based Key Derivation
                     Functions] in accordance with a specified cryptographic algorithm [HMAC- 
                     <selectables>
                        
                        <selectable>SHA-256</selectable>
                        
                        <selectable>SHA-384</selectable>
                        
                        <selectable>SHA-512</selectable>
                        
                     </selectables> ], with [assignment: positive integer of 4096 or more] iterations, and
                     output cryptographic key sizes 
                     <selectables>
                        
                        <selectable>128</selectable>
                        
                        <selectable>256</selectable>
                        
                     </selectables> that meet the following: [NIST SP 800-132]. 
                     
                  </title>
                  
               </f-element>
               
               <f-element id="FCS_CKM.1.4(A)">
                  
                  <title>
                     <b xmlns="">Refinement:</b> The TSF shall not accept passwords less than [selection: a value settable by the administrator, 
                     [assignment: minimum password length accepted by the TOE, must be &gt;= 1]] and greater than the maximum password length 
                     defined in FCS_CKM_EXT.1.1(A).
                  </title>
                  
               </f-element>
               
               <f-element id="FCS_CKM.1.5(A)">
                  
                  <title>The TSF shall generate all salts using a RBG that meets FCS_RBG_EXT.1 (from the AS PP) and with entropy 
                     corresponding to the security strength selected for PBKDF in FCS_CKM_EXT.1.3(A).
                  </title>
                  
                  <note role="application"> The password/passphrase is represented on the host machine as a sequence of characters whose 
                     encoding depends on the TOE and the underlying OS. This sequence must be conditioned into a string of bits that is to be used
                     as a KEK that is the same size as the FEK.
                     
                     For FCS_CKM_EXT.1.1(A), the ST author assigns the maximum size of the password/passphrase it supports; it must support at
                     least 64 characters.
                     
                     For FCS_CKM_EXT.1.2(A), the ST author assigns any other supported characters; if there are no other supported characters,
                     
                     they should select &#8220;no other characters&#8221;.
                     
                     For FCS_CKM_EXT.1.3(A), the ST author selects the parameters based on the PBKDF used by the TSF. The key cryptographic
                     key sizes in are made to correspond to the KEK key sizes selected in FCS_CKM_EXT.1.
                     
                     The password/passphrase must be conditioned into a string of bits that forms the submask to be used as input into the
                     KEK. Conditioning is performed using one of the identified hash functions in accordance with the process described in
                     NIST SP 800-132. SP 800-132 requires the use of a pseudo-random function (PRF) consisting of HMAC with an approved hash function.
                     
                     Appendix A of SP 800-132 recommends setting the iteration count in order to increase the computation needed to derive
                     a key from a password and, therefore, increase the workload of performing a password recovery attack. However, for this EP,
                     a minimum iteration count of 4096 is required in order to ensure that twelve bits of security is added to the password/passphrase
                     value.
                     A significantly higher value is recommended to ensure optimal security.
                     
                     For FCS_CKM_EXT.1.4(A) If the minimum password length is settable, then ST author chooses &#8220;a value settable by the administrator
                     for this component, as well as the &#8220;configure password/passphrase complexity setting&#8221; item for FMT_SMF.1.1. If the minimum
                     length
                     is not settable, the ST author fills in the assignment with the minimum length the password must be (zero-length passwords
                     are not allowed for compliant TOEs).  
                  </note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4> FCS_CKM_1.1(A): There are two aspects of this component that require
                     evaluation: passwords/passphrases of the length specified in the requirement (at least
                     64 characters) are supported, and that the characters that are input are subject to the
                     selected conditioning function. These activities are separately addressed in the text
                     below. <br xmlns="">Support for minimum length:The evaluators shall check to ensure that the 
                     TSS describes the allowable ranges for password/passphrase lengths, and that at least 64 characters may be specified by the
                     user.
                     <br xmlns="">Support for PBKDF: The evaluator shall examine the password hierarchy TSS to ensure
                     that the formation of all KEKs or FEKs (as decided in the FCS_CKM_EXT.1 selection) is
                     described and that the key sizes match that described by the ST author. <br xmlns="">The
                     evaluator shall check that the TSS describes the method by which the password/passphrase
                     is first encoded and then fed to the SHA algorithm. The settings for the algorithm
                     (padding, blocking, etc.) shall be described, and the evaluator shall verify that these
                     are supported by the selections in this component as well as the selections concerning
                     the hash function itself. The evaluator shall verify that the TSS contains a description
                     of how the output of the hash function is used to form the submask that will be input
                     into the function and is the same length as the KEK as specified in FCS_CKM_EXT.4.
                     <br xmlns="">For the NIST SP 800-132-based conditioning of the password/passphrase, the required
                     assurance activities will be performed when doing the assurance activities for the
                     appropriate requirements (FCS_COP.1.1(4)). If any manipulation of the key is performed
                     in forming the submask that will be used to form the FEK or KEK, that process shall be
                     described in the TSS. <br xmlns="">No explicit testing of the formation of the submask from the
                     input password is required. <br xmlns=""> FCS_CKM_1.2(A): The ST author shall provide a
                     description in the TSS regarding the salt generation. The evaluator shall confirm that
                     the salt is generated using an RBG described in FCS_RBG_EXT.1 (from the <cite linkend="bibAppPP"></cite>). 
                     <h4 xmlns="">Guidance</h4>
                     <b xmlns="">Support for minimum length:</b> The evaluators shall check the Operational Guidance 
                     to determine that there are instructions on how to generate large passwords/passphrases, and
                     instructions on how to configure the password/passphrase length (and optional complexity settings)
                     to provide entropy commensurate with the keys that the authorization factor is protecting.  
                     
                     
                     <h4 xmlns="">Tests</h4> SSupport for Password/Passphrase characteristics: In addition to the analysis above, 
                     the evaluator shall also perform the following tests on a TOE configured according to the Operational Guidance: 
                     <testlist>
                        
                        <test>Ensure that the TOE supports passwords/passphrases of a minimum length of 64 characters. </test>
                        
                        <test>Ensure that the TOE does not accept more than the maximum number of characters specified in FCS_CKM_EXT.1.1(A). </test>
                        
                        <test> Ensure that the TOE does not accept less than the minimum number of characters specified in FCS_CKM_EXT.1.4(A).
                           If the minimum length is settable by the administrator, the evaluator determines the minimum length or lengths to test.
                        </test>
                        
                        <test> Ensure that the TOE supports passwords consisting of all characters listed in FCS_CKM_EXT.1.2(A).</test>
                        
                     </testlist>
                     <b xmlns="">Conditioning:</b> No explicit testing of the formation of the authorization factor
                     from the input password/passphrase is required. <b xmlns="">Iteration count:</b> The evaluator
                     shall verify that the iteration count for PBKDFs performed by the TOE comply with NIST
                     SP 800-132 by ensuring that the TSS contains a description of the estimated time
                     required to derive key material from passwords and how the TOE increases the computation
                     time for password-based key derivation (including but not limited to increasing the
                     iteration count). 
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
            <f-component id="FCS_CKM.1(1) " name="Cryptographic Key Generation (for asymmetric keys)" status="sel-based"> 
               
               <selection-depends req="FCS_CKM_EXT.2.1" ids="qqqq"></selection-depends>
               
               <f-element id="FCS_CKM.1.1(1)">
                  
                  <title><b xmlns="">Refinement:</b> The application shall [selection: invoke platform-provided
                     functionality, implement functionality] shall generate <b xmlns="">asymmetric</b> cryptographic
                     keys <b xmlns="">used for key establishment</b> in accordance with NIST Special Publication
                     800-56A, &#8220;Recommendation for Pair-Wise Key Establishment Schemes Using Discrete
                     Logarithm Cryptography&#8221; for elliptic curve-based key establishment schemes and
                     implementing &#8220;NIST curves&#8221; 
                     <selectables>
                        
                        <selectable>P-256</selectable>
                        
                        <selectable>P-384</selectable>
                        
                     </selectables> (as defined in FIPS PUB 186-4, &#8220;Digital Signature Standard&#8221;) and
                     specified cryptographic key sizes equivalent to, or greater than, a symmetric key
                     strength of 112 bits. 
                  </title>
                  
                  <note role="application"> This component requires that the TOE/TOE platform be able to
                     generate the public/private key pairs that are used for key establishment purposes when
                     ECC CDH is used to protect the FEK; the ST author selects the entity that is performing
                     the key generation activity in the first selection. <br xmlns="">The ST author also chooses the
                     curves that are supported for the key pair generation activity; either or both can be
                     selected. If ECC CDH is one of the methods used to protect the FEK as specified in FCS_COP.1(5) by the ST
                     author, ephemeral keys are required to be generated and used to generate the shared secret
                     used to protect the FEK. The following component will be included by the ST author when this
                     selection is made. 
                  </note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4>
                     <b xmlns="">Requirement met by the TOE</b><br xmlns=""> The evaluator shall examine the TSS to ensure
                     that it specifies which key size is used.<br xmlns="">
                     <b xmlns="">Requirement met by the Platform</b><br xmlns=""> The evaluator shall examine the TSS to
                     verify that it describes how the key establishment algorithm is invoked.
                     
                     <h4 xmlns="">Guidance</h4>None. 
                     <h4 xmlns="">Tests</h4><b xmlns="">Requirement met by the TOE</b><br xmlns="">
                     <b xmlns="">ECC Key Generation Test </b><br xmlns=""> For each supported NIST curve selected by the ST
                     author, the evaluator shall require the implementation under test (IUT) to generate 10
                     private/public key pairs. The private key shall be generated using an approved random
                     bit generator (RBG). To determine correctness, the evaluator shall submit the generated
                     key pairs to the public key verification (PKV) function of a known good implementation. <br xmlns="">
                     <b xmlns="">ECC Public Key Verification (PKV) Test</b>
                     <br xmlns=""> For each supported NIST curve selected by the ST author, the evaluator shall
                     generate 10 private/public key pairs using the key generation function of a known good
                     implementation and modify five of the public key values so that they are incorrect,
                     leaving five values unchanged (i.e., correct). The evaluator shall obtain in response a
                     set of 10 PASS/FAIL values. 
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
            <f-component id="FCS_COP.1(4)" name="Cryptographic Operation (Keyed-Hash Message Authentication)" status="sel-based">
               
               <selection-depends req="FCS_CKM_EXT.1.3" ids="qqqq"></selection-depends>
               
               <f-element id="FCS_COP.1.1(4)">
                  
                  <title><b xmlns="">Refinement:</b> The application shall 
                     <selectables>
                        
                        <selectable>invoke platform-provided functionality</selectable>
                        
                        <selectable>implement functionality</selectable>
                        
                     </selectables> to perform <b xmlns="">keyed-hash message authentication</b> in accordance with a
                     specified cryptographic algorithm <b xmlns="">HMAC-</b>
                     
                     <selectables>
                        
                        <selectable>SHA-256</selectable>
                        
                        <selectable>SHA-384</selectable>
                        
                        <selectable>SHA-512</selectable>
                        
                     </selectables> , key size [assignment: key size (in bits) used in HMAC], <b xmlns="">and message
                        digest size of</b>
                     
                     <selectables>
                        
                        <selectable>256</selectable>
                        
                        <selectable>384</selectable>
                        
                        <selectable>512</selectable>
                        
                     </selectables> bits that meet the following: <b xmlns="">FIPS PUB 198-1, &#8220;The Keyed-Hash Message
                        Authentication Code&#8221;, and FIPS PUB 180-4, &#8220;Secure Hash Standard&#8221;.</b>
                     
                  </title>
                  
                  <note role="application"> The selection of the hashing algorithm must correspond to the
                     selection of the message digest size; for example, if HMAC-SHA-256 is chosen, then the
                     only valid message digest size selection would be 256 bits. <br xmlns="">The message digest size
                     above corresponds to the underlying hash algorithm used. Note that truncating the output
                     of the HMAC following the hash calculation is an appropriate step in a variety of
                     applications. This does not invalidate compliance with this requirement, however, the ST
                     should state that truncation is performed, the size of the final output, and the
                     standard to which this truncation complies. <br xmlns="">The evaluator shall check that the
                     association of the keyed-hash function with other cryptographic functions specified in
                     the file encryption product ST (whether these are performed by the platform or by the
                     TOE) that either use or are used by the keyed-hash function is documented in the TSS. 
                  </note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4>
                     <b xmlns="">Requirement met by the TOE</b>
                     <br xmlns=""> For all cases where the output of the HMAC following the hash calculation is
                     truncated, the evaluator shall ensure that the TSS states for what operation this
                     truncation takes place; the size of the final output; and the standard to which this
                     truncation complies. <br xmlns=""> The evaluator shall examine the TSS to ensure that it
                     specifies the following values used by the HMAC function: key&shy;length, hash function
                     used, block size, and output MAC length used. <br xmlns="">
                     <b xmlns="">Requirement met by the Platform</b>
                     <br xmlns=""> The evaluator shall examine the TSS to verify that it describes how the keyed hash
                     function algorithm is invoked. 
                     <h4 xmlns="">Guidance</h4> None. 
                     <h4 xmlns="">Tests</h4>
                     <b xmlns="">Requirement met by the TOE</b> For each of the supported parameter sets, the
                     evaluator shall compose 15 sets of test data. Each set shall consist of a key and
                     message data. The evaluator shall have the TSF generate HMAC tags for these sets of test
                     data. The resulting MAC tags shall be compared to the result of generating HMAC tags
                     with the same key and IV using a known good implementation. 
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
            <f-component id="FCS_SMC_EXT.1 " name="Submask Combining " status="sel-based">
               
               <selection-depends req="FPT_KYP_EXT.1.1" ids="qqqq"></selection-depends>
               
               <f-element id="FCS_SMC_EXT.1.1 ">
                  
                  <title>The TSF shall combine submasks using the following method 
                     <selectables>
                        
                        <selectable>exclusive OR (XOR)</selectable>
                        
                        <selectable>SHA-256</selectable>
                        
                        <selectable>SHA-512</selectable>
                        
                     </selectables> to generate an intermediary key or BEV.
                  </title>
                  
                  <note role="application">This requirement specifies the way that a product may combine the
                     various submasks by using either an XOR or an approved SHA-hash. 
                  </note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4> If keys are XORed together to form an intermediate key, the TSS section
                     shall identify how this is performed (e.g., if there are ordering requirements, checks
                     performed, etc.). The evaluator shall also confirm that the TSS describes how the length
                     of the output produced is at least the same as that of the FEK. 
                     <h4 xmlns="">Guidance</h4>None.
                     
                     <h4 xmlns="">Tests</h4>None. 
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
            <f-component id="FCS_CKM_EXT.1" name="Key Encrypting Key (KEK) Support" status="sel-based">
               
               <selection-depends req="INSERTANDFIX_CKM_EXT.2.1" ids="qqqq"></selection-depends>
               
               <f-element id="FCS_CKM_EXT.1.1 ">
                  
                  <title> The TSF shall support the derivation of KEK in the following manner based:<br xmlns="">
                     
                     <selectables linebreak="yes">
                        
                        <selectable>derive a KEK using a password-based authorization factor conditioned as
                           defined in FCS_CKM.1(A) and in accordance with FIA_FCT_EXT.1(2)or FIA_FCT_EXT.1(3)
                        </selectable>
                        
                        <selectable>support external authorization factors on an external entity using RSA key
                           pairs protected by the external entity and in accordance with
                           FIA_FCT_EXT.1(1)
                        </selectable>
                        
                        <selectable>support external authorization factors on an external entity using ECC key
                           pairs protected by the external entity and in accordance with
                           FIA_FCT_EXT.1(1)
                        </selectable>
                        
                        <selectable>using a Random Bit Generator as specified in FCS_RBG_EXT.1 (from the AS
                           PP) and with entropy corresponding to the security strength of AES key sizes of 
                           <selectables>
                              
                              <selectable>128 bit</selectable>
                              
                              <selectable>256 bit</selectable>
                              
                           </selectables>
                           
                        </selectable>
                        
                     </selectables>
                     
                  </title>
                  
               </f-element>
               
               <f-element id="FCS_CKM_EXT.1.2">
                  
                  <title>All KEKs shall be 
                     <selectables>
                        
                        <selectable>128 bit</selectable>
                        
                        <selectable>256 bit</selectable>
                        
                     </selectables> keys corresponding to at least the security strength of the keys
                     encrypted by the KEK.
                  </title>
                  
                  <note role="application"> The ST author must include in the ST the appropriate component
                     from Appendix C concerning the generation/support of the selected authorization factor.
                     As previously indicated, the authorization factor can either be derived by the TSF in
                     the case of passwords/passphrases or using an RBG, or the TOE can use an external entity
                     that contains a key pair associated with that user that is used to protect the FEK (the
                     TSF in this case will have a reduced role in the cryptographic operations involving the
                     KEK and FEK depending on the specific scheme and implementation used; some cryptographic
                     functions will be provided by the external entity (such as those used to decrypt the
                     FEK)). <br xmlns=""> A password is a protected/private string of letters, numbers, and/or
                     special characters used to authenticate an identity or to authorize access to data. One
                     concern is that a secure password may be hard to remember and the user may write it
                     down. A passphrase is a sequence of words, preferably unrelated. Because words are
                     easier for a user to remember, it is possible to create a long passphrase meeting the
                     requirements laid out in Appendix C that will be as secure as a shorter, more
                     complicated to remember password. <br xmlns=""> For this selection, the ST author selects one
                     (or more, if the TOE supports multiple authorization factors) of the listed
                     authorization factors. The TSF will be responsible for conditioning the key when
                     selecting the password/passphrase. If an external entity contains at least some portion
                     of the authorization factor, regardless of the implementation (smartcard, library on the
                     OS hosting the TOE), the second or third item will be selected, depending on how the FEK
                     is protected. If a KEK is randomly generated, the fourth item is selected. In all cases,
                     the appropriate requirements from Appendix C should be included to reflect the
                     authorization factor(s) used. 
                  </note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4> The assurance activity for this component entails examination of the ST&#8217;s
                     TSS to determine that the TOE&#8217;s implementation of the requirements is documented. The
                     evaluators shall first examine the TSS section to ensure that the authorization factors
                     specified in the ST are described. For password/passphrase-based factors, the
                     examination of the TSS section is performed as part of FCS_CKM.1(A) assurance
                     activities. <br xmlns=""> If external authorization factors are supported, then the evaluator
                     will perform the following activities (these may be performed in conjunction with those
                     performed for FCS_COP.1(5) and FIA_FCT_EXT.1(1)). The evaluator checks to ensure that
                     the TSS describes the method used by the TSF to invoke the function used to protect the
                     private key of the user on the external entity. If this function is provided by the
                     external entity itself and not by the TSF, then the evaluator shall ensure the TSS
                     describes the method by which the TSS can detect that the private key was successfully
                     accessed by the external entity. <br xmlns=""> The evaluator shall also check that the TSS
                     describes how the TSF invokes either the RSA or ECC functionality in the external
                     entity; this must include a description of both an encryption and decryption scenario
                     for the FEK. This description shall include the manner in which the external entity is
                     invoked to ensure that the requirements for the FEK protection listed in FCS_COP.1(5)
                     are met. 
                     <h4 xmlns="">Guidance</h4> The evaluator shall check the Operational Guidance to ensure
                     that any configuration of the TSF to support the authorization factors selected is
                     present. For instance, if external entities are to be used to decrypt/encrypt the FEK,
                     instructions for setting up the TOE to recognize the external entities (if needed) must
                     be present. The evaluator shall also check the Operational Guidance to ensure that
                     adequate warning is given to users regarding the importance of having
                     passwords/passphrases with strong entropy. 
                     <h4 xmlns="">Tests</h4> The evaluators also perform
                     the following assurance activities: tests: 
                     <testlist>
                        
                        <test>[conditional] If the TOE performs input validation on password/passphrase
                           authorization factors (e.g., correct length of factor), perform tests to ensure the
                           input validation routines identify malformed authorization factors.
                        </test>
                        
                        <test>An example ciphertext file generated via the TOE shall be provided to the
                           evaluator with the accompanying KEK and prerequisite authorization information used
                           for encryption. The evaluator will use the TOE in conjunction with a debugging or
                           forensics utility to attempt a decrypt of the ciphertext file using the provided
                           authorization information. The evaluator will then terminate processing of the TOE
                           and perform a search through non-volatile memory using the provided KEK string. The
                           evaluator must document each command, program or action taken during this process,
                           and must confirm that the KEK was never written to non-volatile memory. This test
                           must be performed three times to ensure repeatability. If during the course of this
                           testing the evaluator finds that the KEK was written to non-volatile memory, they
                           should be able to identify the cause (i.e. the TOE wrote the KEK to disk, the TOE
                           platform dumped volatile memory as a page file, etc.), and document the reason for
                           failure to comply with the requirement.
                        </test>
                        
                     </testlist> Other testing is performed with the FIA_FCT_EXT.1, FCS_COP.1(5), and
                     FDP_PRT_EXT.1 assurance activities. 
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
            
         </subsection>
         
         
         <subsection title="User Data Protection (FDP)" id="fdp">
            
            <f-component id="FDP_PRT_EXT.1" name="Extended: Protection of Selected User Data">
               
               <f-element id="FDP_PRT_EXT.1.1">
                  
                  <title>The TSF shall perform encryption and decryption of the user-selected file (or set
                     of files) in accordance with FCS_COP.1(1). 
                  </title>
                  
                  <note role="application">This is the primary requirement for encrypting and decrypting
                     the protected resources (files and sets of files). Apart from the actual encryption
                     and decryption of the resources, there are two other functions specified by this
                     requirement. 
                  </note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4> FDP_PRT_EXT.1.1: The evaluator shall examine the TSS to determine that it
                     lists each type of resource that can be encrypted (e.g., file, directory) and what
                     &#8220;encrypted&#8221; means in terms of the resource (e.g., &#8220;encrypting a directory&#8221; means that
                     all of the files contained in the directory are encrypted, but the data in the
                     directory itself (which are filenames and pointers to the files) are not encrypted).
                     The evaluator shall also confirm that the TSS describes how each type of resource
                     listed is encrypted and decrypted by the TOE. The evaluator shall ensure that this
                     description includes the case where an existing file or set of files is encrypted for
                     the first time; a new file or set of files is created and encrypted; an existing file
                     or set of files is re-encrypted (that is, it had been initially encrypted; it was
                     decrypted (by the TOE) for use by the user, and is then subsequently re-encrypted);
                     and corresponding decryption scenarios. If other scenarios exist due to product
                     implementation/features, the evaluator shall ensure that those scenarios are covered
                     in the TSS as well. 
                     <h4 xmlns="">Guidance</h4> If the TOE creates temporary objects and these
                     objects can be protected through administrative measures (e.g., the TOE creates
                     temporary files in a designated directory that can be protected through configuration
                     of its access control permissions), then the evaluator shall check the Operational
                     Guidance to ensure that these measures are described. <br xmlns=""> If there are special
                     measures necessary to configure the method by which the file or set of files are
                     encrypted (e.g., choice of algorithm used, key size, etc.), then those instructions
                     shall be included in the Operational Guidance and verified by the evaluator. In these
                     cases, the evaluator checks to ensure that all non-TOE products used to satisfy the
                     requirements of the ST that are described in the Operational Guidance are consistent
                     with those listed in the ST, and those tested by the assurance activities of this EP.
                     
                     <h4 xmlns="">Tests</h4> The evaluator shall also perform the following tests. All
                     instructions for configuring the TOE and each of the environments must be included in
                     the Operational Guidance and used to establish the test configuration.<br xmlns=""> For each
                     resource and decryption/encryption scenario listed in the TSS, the evaluator shall
                     ensure that the TSF is able to successfully encrypt and decrypt the resource using the
                     following methodology:<br xmlns=""> Monitor the temporary resources being created (if any) and
                     deleted by the TSF&#8212;the tools used to perform the monitoring (e.g., procmon for a
                     Windows system) shall be identified in the test report. The evaluator shall ensure
                     that these resources are consistent with those identified in the TSS, and that they
                     are protected as specified in the Operational Guidance and are deleted when the
                     decryption/encryption operation is completed. 
                  </aactivity>
                  
               </f-element>
               
               <f-element id="FDP_PRT_EXT.1.2">
                  
                  <title> The application shall 
                     <selectables>
                        
                        <selectable>invoke platform-provided functionality</selectable>
                        
                        <selectable>implement functionality</selectable>
                        
                     </selectables> to ensure that all sensitive data created by the TOE when
                     decrypting/encrypting the user-selected file (or set of files) are destroyed in
                     volatile and non-volatile memory when the data is no longer needed. 
                  </title>
                  
                  <note role="application"> The intent is that the TSF controls the use and clearing of any data
                     that it manipulates that is not needed by the user (e.g. a temporary file created in non-volatile
                     memory during the encryption/decryption process would be destroyed as soon as the process is completed).
                     This should not prevent expected usage (e.g. the TOE may create a decrypted copy of a file as requested
                     by the user).The TSF is also not responsible for temporary files that  non-TSF application creates 
                     (for example, a text editor may create a &#8220;checkpoint&#8221; file when editing a file that is protected by the TOE;
                     the TOE does not have to try to keep track of or clean up these &#8220;checkpoint&#8221; files). An optional
                     requirement on cleaning up the temporary files created by non-TSF application when operating on
                     files protected by the TOE is in Appendix B. 
                  </note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4>
                     <b xmlns="">Requirement met by the TOE</b>
                     <br xmlns=""> The evaluator shall examine the TSS to ensure there is a high-level description
                     of how the FEK is protected. <br xmlns="">The evaluator shall examine the TSS to ensure there
                     is a description of how the FEK is protected. The evaluator shall examine the TSS to ensure 
                     that it describes all temporary files/resources created or memory used during the 
                     decryption/encryption process and when those files/resources or memory is no longer needed. 
                     The TSS shall describe how the TSF or TOE platform deletes the non-volatile memory (for example, files) 
                     and volatile memory locations after the TSF is done with its decryption/encryption operation. 
                     
                     <h4 xmlns="">Guidance</h4>
                     None. 
                     <h4 xmlns="">Tests</h4> 
                     
                     <testlist>
                        <test>This test only applies for application provided functionality.</test>
                        
                        1. Using a file editor, create and save a text file that is encrypted per the evaluation configured encryption policy.  The
                        contents of the file will be limited to a known text pattern to ensure that the text pattern will be present in all encryption/decryption
                        operations performed by the TOE.
                        
                        2. Exit the file editor so that the file (including its known text pattern) has &#8220;completed the decryption/encryption operation&#8221;
                        and process memory containing the known text pattern is released.
                        
                        3. The evaluator will take a dump of volatile memory and search the generated dump for the known pattern.  The test fails
                        if the known plaintext pattern is found in the memory dump.
                        
                        4. Open the file again with a file editor. 
                        
                        5. The evaluator will take a dump of volatile memory and search the generated dump for the known text pattern.  Note that
                        the known text pattern is expected to be present since the file editor has the file open. The test fails if the known plaintext
                        pattern is not found in the memory dump.
                        
                        6. Close the file and exit the file editor.
                        
                        7. The evaluator will take a dump of volatile memory and search the retrieved dump for the known pattern.  The test fails
                        if the known plaintext pattern is found in the memory dump.
                     </testlist>
                     
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
            <f-component id="FDP_AUT_EXT.1" name="Extended: Authentication of Selected User Data " status="optional">
               
               <f-element id="FDP_AUT_EXT.1.1">
                  
                  <title>The TSF shall perform authentication of the user-selected file (or set of files)
                     and provide notification to the user if modification had been detected. 
                  </title>
                  
               </f-element>
               
               <f-element id="FDP_AUT_EXT.1.2">
                  
                  <title> The TSF shall implement a data authentication method based on 
                     <selectables>
                        
                        <selectable>cryptographic, keyed hashing service and verification in accordance with
                           FDP_AUT_EXT.2
                        </selectable>
                        
                        <selectable>asymmetric signing and verification in accordance with
                           FDP_AUT_EXT.3
                        </selectable>
                        
                     </selectables>. 
                  </title>
                  
                  <note role="application">49 This is the primary requirement for authentication of the
                     protected resources (files and sets of files). It is highly encouraged for vendors to
                     utilize a keyed hashing service or asymmetric signing mechanism to ensure data
                     authentication, as these are the only two implementations noted in this EP that prevent
                     decryption if authentication is unsuccessful. Using modes such as XTS or CBC will
                     require additional data authentication measures to be added, such as a keyed hash
                     function or asymmetric signing, because these modes do not come inherently packaged with
                     data authentication or a way to signal to the user that data has been modified. 
                  </note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4> The evaluator shall examine the TSS to determine that it lists each type of
                     resource that can be authenticated (e.g., file, directory) and what &#8220;authenticated&#8221;
                     means in terms of the resource (e.g., &#8220;authenticating a directory&#8221; means that all of the
                     files contained in the directory are authenticated, but the data in the directory itself
                     (which are filenames and pointers to the files) are not authenticated). The evaluator
                     shall also confirm that the TSS describes how each type of resource listed is
                     authenticated by the TOE and how authentication measures are added to each resource
                     (e.g. taking all the encrypted files through a MAC function and appending the MAC to the
                     set of files). The evaluator shall ensure that this description includes the case where
                     an existing file or set of files has authentication measures added for the first time; a
                     new file or set of files is created and adds authentication measure; an existing file or
                     set of files updates or replaces its existing authentication measures (that is, it had a
                     MAC appended to the data; it was authenticated and decrypted (by the TOE) for use by the
                     user, and is then subsequently re-encrypted with an updated MAC); and corresponding
                     decryption scenarios. If other scenarios exist due to product implementation/features,
                     the evaluator shall ensure that those scenarios are covered in the TSS as well.
                     
                     <h4 xmlns="">Guidance</h4>If the TOE creates temporary objects and these objects can be
                     protected through administrative measures (e.g., the TOE creates temporary files in a
                     designated directory that can be protected through configuration of its access control
                     permissions), then the evaluator shall check the Operational Guidance to ensure that
                     these measures are described. <br xmlns="">If there are special measures necessary to configure
                     the method by which the file or set of files are authenticated (e.g., choice of function
                     used, additional keys, etc.), then those instructions shall be included in the
                     Operational Guidance and verified by the evaluator. This includes, for instance, lists
                     of allowed platforms, libraries, and devices, and instructions for using them. In these
                     cases, the evaluator checks to ensure that all non-TOE products used to satisfy the
                     requirements of the ST that are described in the Operational Guidance are consistent
                     with those listed in the ST, and those tested by the assurance activities of this EP.
                     
                     <h4 xmlns="">Tests</h4> The evaluator shall also perform the following tests. These tests may
                     be performed in conjunction with the tests listed for FCS_COP.1(2) (from the <cite linkend="bibAppPP"></cite>), FCS_COP.1(3) (from the <cite linkend="bibAppPP"></cite>), and
                     FCS_COP.1(4). These tests must be performed for each data authentication feature and
                     platform claimed in the ST; all instructions for configuring the TOE and each of the
                     environments must be included in the Operational Guidance and used to establish the test
                     configuration. <br xmlns="">For each resource and data authentication scenario listed in the
                     TSS, the evaluator shall ensure that the TSF is able to successfully add authentication
                     measures and authenticate the resource using the following methodology. <br xmlns="">Monitor the
                     temporary resources being created (if any) and deleted by the TSF&#8212;the tools used to
                     perform the monitoring (e.g., procmon for a Windows system) shall be identified in the
                     test report. The evaluator shall ensure that these resources are consistent with those
                     identified in the TSS, and that they are protected as specified in the Operational
                     Guidance and are deleted when the decryption/encryption and authentication operations
                     are completed. 
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
            <f-component id="FDP_AUT_EXT.2" name="Extended: Data Authentication using cryptographic, keyed hash functions" status="optional">
               
               <f-element id="FDP_AUT_EXT.2.1">
                  
                  <title>The TSF shall use a cryptographic, keyed hash function in accordance with
                     FCS_COP.1(4).
                  </title>
                  
               </f-element>
               
               <f-element id="FDP_AUT_EXT.2.2">
                  
                  <title>The TSF shall use a File Authentication Key (FAK) in accordance with FCS_COP.1(6)
                     and FCS_CKM_EXT.5 as the secret key to the keyed hash function.
                  </title>
                  
               </f-element>
               
               <f-element id="FDP_AUT_EXT.2.3">
                  
                  <title>The TSF shall use the entirety of the ciphertext file as the message input to the
                     keyed hash function.
                  </title>
                  
               </f-element>
               
               <f-element id="FDP_AUT_EXT.2.4">
                  
                  <title>The TSF shall concatenate the output of the keyed hash function, the Message
                     Authentication Code (MAC).
                  </title>
                  
               </f-element>
               
               <f-element id="FDP_AUT_EXT.2.5">
                  
                  <title>The TSF shall authenticate the encrypted file prior to decryption.</title>
                  
               </f-element>
               
               <f-element id="FDP_AUT_EXT.2.6">
                  
                  <title>The TSF shall authenticate the data by comparing the keyed hash output of the
                     ciphertext against the stored MAC.
                  </title>
                  
               </f-element>
               
               <f-element id="FDP_AUT_EXT.2.7">
                  
                  <title>The TSF shall notify the user of an unsuccessful authentication and prevent
                     decryption of the ciphertext.
                  </title>
                  
               </f-element>
               
               <f-element id="FDP_AUT_EXT.2.8">
                  
                  <title>During verification, the TSF shall assume the MAC is at the end of the ciphertext
                     file.
                  </title>
                  
               </f-element>
               
               <f-element id="FDP_AUT_EXT.2.9">
                  
                  <title>The FAK will be generated using a RBG that meets FCS_RBG_EXT.1 (from the AS
                     PP).
                  </title>
                  
                  <note role="application">The intent of this requirement is to specify the correct way of
                     using a keyed hash function to authenticate the data, and enable authentication of data. 
                  </note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4> 46 The evaluator shall check the TSS section to confirm that it describes
                     how a request for each type of supported resource (file (or set of files)) will result
                     in data authentication using a keyed hash function. The evaluator will confirm that the
                     TOE will respond appropriately to a failed authentication, to include notifying the user
                     of an invalid authentication and preventing decryption. The evaluator will confirm that
                     any file encryption utility will be able to identify where the MAC is placed. <br xmlns="">The
                     evaluator will confirm that a FAK is used as part of the authentication process and will
                     identify the keyed hash function utilized. 
                     <h4 xmlns="">Guidance</h4> 1 It is encouraged for
                     every implementation to use a FAK that is wholly different and independently generated
                     from the FEK. 
                     <h4 xmlns="">Tests</h4> The evaluator shall perform the following test: 
                     <testlist>
                        
                        <test>Create an encrypted file and confirm that authentication of this file using the
                           correct FAK will result in a success.
                        </test>
                        
                        <test>Modify an arbitrary number of bits of ciphertext and attempt to run the
                           authentication and decryption operations on the file. Assert that the TOE
                           successfully identified the forged ciphertext file and notified the user. 
                        </test>
                        
                     </testlist>
                     
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
            <f-component id="FDP_AUT_EXT.3" name="Extended: Data Authentication using asymmetric signing and verification" status="optional">
               
               <f-element id="FDP_AUT_EXT.3.1">
                  
                  <title>The TSF shall use a secure hash function in accordance with FCS_COP.1(3) (from the
                     <cite linkend="bibAppPP"></cite>) with the entire ciphertext file as input to create a
                     hash.
                  </title>
                  
               </f-element>
               
               <f-element id="FDP_AUT_EXT.3.2">
                  
                  <title>The TSF shall use a cryptographic signing function in accordance with FCS_COP.1(2)
                     (from the <cite linkend="bibAppPP"></cite>) and must use the hash generated in accordance with
                     FDP_AUT_EXT.3.1 as input to the signing process. Additionally, use of ephemeral key for
                     signing purposes is prohibited.
                  </title>
                  
               </f-element>
               
               <f-element id="FDP_AUT_EXT.3.3">
                  
                  <title>The TSF shall use a public and private key pair generated in accordance with
                     FIA_CKM.1(1) and must use this key pair as part of the cryptographic signing process in
                     accordance with FDP_AUT_EXT.3.2.
                  </title>
                  
               </f-element>
               
               <f-element id="FDP_AUT_EXT.3.4">
                  
                  <title>The TSF shall authenticate the ciphertext data prior to decryption.</title>
                  
               </f-element>
               
               <f-element id="FDP_AUT_EXT.3.5">
                  
                  <title>The TSF shall notify the user of an unsuccessful authentication and prevent
                     decryption of the ciphertext if such an event were to occur.
                  </title>
                  
               </f-element>
               
               <f-element id="FDP_AUT_EXT.3.6">
                  
                  <title>The TSF shall append the signature to the end of the ciphertext file.</title>
                  
               </f-element>
               
               <f-element id="FDP_AUT_EXT.3.7">
                  
                  <title>During verification, the TSF shall assume the signature is at the end of the
                     ciphertext file.
                  </title>
                  
                  <note role="application">55 The intent of this requirement is to specify the secure way of
                     using a cryptographic signing and hashing function as part of the data authentication
                     mechanism.
                  </note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4> 1 The evaluator shall check the TSS section to confirm that it describes
                     how a request for each type of supported resource (file (or set of files)) will result
                     in data authentication using a secure hash and cryptographic signing process. The
                     evaluator will confirm that the supplied public and private key pair were generated in
                     accordance with FCS_CKM.1(1). The evaluator will confirm that the entire ciphertext file
                     was used to create the hash and that the hash was used as input to the cryptographic
                     signing function. The evaluator will confirm that the TSF notifies the user of an
                     unsuccessful authentication and prevents decryption. 
                     <h4 xmlns="">Guidance</h4> None.
                     
                     <h4 xmlns="">Tests</h4> The evaluator shall perform the following test: 
                     <testlist>
                        
                        <test>Create an encrypted file and demonstrate that authentication of this file using
                           the correct keying material will be successful.
                        </test>
                        
                        <test>Modify an arbitrary number of bits of ciphertext and attempt to run the
                           authentication and decryption operations on the file. Assert that the TOE
                           successfully identified the forged ciphertext file and notified the user. 
                        </test>
                        
                     </testlist>
                     
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
            <f-component id="FDP_PM_EXT.1" name="Extended: Protection of  Data in Power Managed States" status="optional">
               
               <f-element id="FDP_PM_EXT.1.1">
                  
                  <title>The TSF shall protect all data stored to the disk drive during the transition to
                     the [assignment: powered-down state(s) for which this capability is provided] state as
                     per FDP_PRT_EXT.1.1. 
                  </title>
                  
               </f-element>
               
               <f-element id="FDP_PM_EXT.1.2">
                  
                  <title>On the return to a powered-on state from the state(s) indicated in FDP_PM_EXT.1.1,
                     the TSF shall authorize the user in the manner specified in FIA_AUT_EXT.1.1 once before
                     any protected data are decrypted. 
                  </title>
                  
                  <note role="application"> For the first selection, the ST author fills in the state using
                     the same name used in the Operational Guidance for the state that is appropriately
                     protected by the TOE. <br xmlns=""> It should be noted that it is not sufficient to use
                     Operational Environment-based credentials to unlock the TOE from the indicated state;
                     the intent is that returning from the indicated state is equivalent (from an
                     authorization point of view) to returning from a completely powered-off state and
                     re-opening the resources that are protected. 
                  </note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4>The evaluator shall examine the TSS to ensure that it describes the state(s)
                     that are supported by this capability. For each state, the evaluator ensures that the
                     TSS contains a description of how the state is entered, and the actions of the TSF on
                     entering the state, specifically addressing how multiple open resources (of each type)
                     are protected, and how keying material associated with these resources is protected (if
                     different from that described elsewhere). The TSF shall also describe how the state is
                     exited, and how the requirements are met during this transition to an operational state.
                     
                     <h4 xmlns="">Guidance</h4> The evaluator shall check the Operational Guidance to determine that
                     it describes the states that are supported by the TOE, and provides information related
                     to the correct configuration of these modes and the TOE. 
                     <h4 xmlns="">Tests</h4> The following
                     tests must be performed by the evaluator for each supported State, type of resource,
                     platform, and authorization factor:
                     <testlist>
                        
                        <test>Following the Operational guidance, configure the Operational Environment and
                           the TOE so that the lower power state of the platform is protected. Open several
                           resources (documented in the test report) that are protected. Invoke the lower power
                           state. On resumption of normal power an attempting to access a previously-opened
                           protected resource, observe that an incorrect entry of the authorization factor(s)
                           does not result in access to the system, and that correct entry of the authorization
                           factor(s) does result in access to the resources. 
                        </test>
                        
                     </testlist>
                     
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
            <f-component id="FDP_PRT_EXT.2" name="Extended: Protection of Selected User Data" status="optional">
               
               <f-element id="FDP_PRT_EXT.2.1">
                  
                  <title>The application shall [selection: invoke platform-provided functionality, implement
                     functionality] to ensure that all original plaintext data created when
                     decrypting/encrypting the user-selected file (or set of files) are destroyed in volatile
                     and non-volatile memory upon completion of the decryption/encryption operation.
                  </title>
                  
               </f-element>
               
               <f-element id="FDP_PRT_EXT.2.2">
                  
                  <title>The TSF shall support more than one user being able to access the same encrypted
                     resource, each using a different authorization factor.
                  </title>
                  
               </f-element>
               
               <f-element id="FDP_PRT_EXT.2.3">
                  
                  <title>The TSF shall ensure that all temporary files created (including those by a
                     third-party application, for example an editor) when decrypting/encrypting the
                     user-selected file (or set of files) are removed or encrypted upon completion of the
                     decryption/encryption operation.
                  </title>
                  
                  <note role="application"> This is the primary requirement for encrypting and decrypting
                     the protected resources (file or set of files). Apart from the actual encryption and
                     decryption of the resources, there are three other functions specified by this
                     requirement. <br xmlns="">FDP_PRT_EXT.2.2 requires that a single resource (file or set of files)
                     be able to be encrypted, but sharable among more than one user. The TSF must support
                     each user having a different authorization factor, which could be the same type of
                     authorization factor but just a different value (like two different passwords), or
                     different types of authorization factors altogether. <br xmlns=""> For FDP_PRT_EXT.2.2-2.3, the
                     intent is that the TSF controls the use and clearing of any data that it manipulates. It
                     needs to ensure that no plaintext data from encrypted resources, or any plaintext key
                     material that could be used to recover that information from the encrypted resource,
                     remains after the TSF has finished operating on that resource. In the context of
                     FDP_PRT_EXT.2.2, the TSF has completed the decryption operation after it has decrypted
                     the file or set of files for use by an application, and completed the encryption
                     operation after it has encrypted the file or set of files for storage in the file
                     system. 
                  </note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4> FDP_PRT_EXT.2.2 - The evaluator shall examine the TSS to determine that it
                     identifies each of the resources that is sharable in encrypted form (for instance,
                     encrypted files may be sharable among users, but encrypted directories may not), and the
                     method by which the resource can be shared among users with different authorization
                     factors. This description shall also cover the TSF actions when adding or removing users
                     to the set allowed to access the file. <br xmlns=""> FDP_PRT_EXT.2.3 - The evaluator shall
                     examine the TSS to ensure that it describes all temporary file (or set of files) that
                     are created in the filesystem of the host during the decryption/encryption process, and
                     that the TSS describes how these files are deleted after the TSF is done with its
                     decryption/encryption operation. Note that if other objects/resources are created on the
                     host that are 1) persistent and 2) visible to other processes (users) on that host that
                     are not filesystem objects, those objects shall be identified and described in the TSS
                     as well. 
                     <h4 xmlns="">Guidance</h4> FDP_PRT_EXT.2.2 - The evaluator shall examine the operation
                     guidance to determine that it contains instructions on how to set up and share resources
                     with other users, if additional actions are necessary due to use of the encryption
                     product. If different for different underlying platforms, the evaluator determines that
                     all platforms listed in the ST are addressed. 
                     <h4 xmlns="">Tests</h4>
                     
                     <testlist>
                        
                        <test>For each type of resource that is identified in the TSS as sharable in its
                           encrypted form, the evaluator shall ensure that different users using different
                           authorization factors are able to successfully access the resource using different
                           authorization factors. This should include making changes to the resource to ensure
                           that the same resource is being shared, and that a per-user copy of the resource is
                           not being made.
                        </test>
                        
                        <test>If the TSS or the third party file editor creates temporary files/resources
                           during file decryption/encryption, the evaluator shall perform the following tests
                           to verify that the temporary files/resources are destroyed. The evaluator shall use
                           a tool (e.g., procmon for a Windows system) that is capable of monitoring the
                           creation and deletion of files during the decryption/encryption process is
                           performed. A tool that can search the contents of the hard drive (e.g., winhex) will
                           also be needed. The tools used to perform the monitoring shall be identified in the
                           test report. 
                        </test>
                        
                     </testlist> Test A (Creating an encrypted document) 
                     <ul xmlns="">
                        
                        <li>Open an editing application.</li>
                        
                        <li>Create a special string inside the document. The string could be 5-10 words. It is
                           recommended to remove the spaces. This will create a one page document.
                        </li>
                        
                        <li>Start the file monitoring tool.</li>
                        
                        <li>Save and close the file.</li>
                        
                        <li>Encrypt the file using the TOE (if the TOE does not encrypt automatically for the
                           user).
                        </li>
                        
                     </ul>
                     <b xmlns="">Analysis Steps </b>
                     
                     <ul xmlns="">
                        
                        <li>If needed, exit/close the TOE.</li>
                        
                        <li>Stop the file monitoring tool. View the results. Identify any temporary files that
                           were created during the encryption process. Examine to see if the temporary files
                           were destroyed when the TOE closed. 
                        </li>
                        
                        <li>If temporary files remain, these temporary files should be examined to ensure that
                           no plaintext data remains. If plaintext data is found in these files, that means
                           that plaintext from the encrypted file remains on the hard drive.
                        </li>
                        
                        <li>Search the contents of the hard drive (using the second tool) for the plaintext
                           string used above. (The search should be performed using both ASCII and Unicode
                           formats.)
                        </li>
                        
                        <li>If the string is found, this means that plaintext from the encrypted file remains
                           on the hard drive. 
                        </li>
                        
                     </ul> Test B (Creating, Encrypting a blank document and then adding text): 
                     <ul xmlns="">
                        
                        <li>Encrypt a blank document using the tool.</li>
                        
                        <li>Create a special string inside the document. The string could be 5-10 words. It is
                           recommended to remove the spaces. This will create a one page document.
                        </li>
                        
                        <li>Start the file monitoring tool.</li>
                        
                        <li>Save and close the file. </li>
                        
                        <li>Perform the &#8220;Analysis Steps&#8221; listed above</li>
                        
                        <li>If Test 1 fails and Test 2 passes, the Operational Guidance shall include
                           instructions for the users to perform encryption in the manner outlined in Test
                           2.
                        </li>
                        
                     </ul>
                     <br xmlns=""> Assumption: Regardless of the length of the file, it is assumed that if any
                     fragment of the original string is found, this reflects that there is a problem with the
                     cleanup with the file encryptor. 
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
         </subsection>
         
         <subsection title="Identification and Authentication (FIA)" id="fia">
            
            <f-component id="FIA_AUT_EXT.1" name="User Authorization">
               
               <f-element id="FIA_AUT_EXT.1.1">
                  
                  <title>The application shall 
                     <selectables>
                        
                        <selectable>implement platform-provided functionality to provide user
                           authorization
                        </selectable>
                        
                        <selectable>provide user authorization</selectable>
                        
                     </selectables> based on 
                     <selectables>
                        
                        <selectable>external entity authorization factors</selectable>
                        
                        <selectable>password/passphrase authorization factors</selectable>
                        
                     </selectables>
                     
                  </title>
                  
                  <note role="application">Requirements that pertain to the selection are contained in Appendix C. The ST author will include FIA_FCT_EXT.1(1) in the
                     ST if the TOE supports RSA/ECC CDH authorization factors, and will include FIA_FCT_EXT.1(2) or FIA_FCT_EXT.1(3) in the ST
                     if the TOE supports password/passphrase authorization factors. It is possible that the platform is providing the actual authorization
                     functionality 
                  </note>
                  
                  <aactivity>The assurance activities for this component will be driven by the selections
                     made by the ST author. This section describes assurance activities for all possible
                     selections in an ST; it should be understood that if a capability is not selected in
                     the ST, the noted assurance activity does not need to be performed. 
                     <h4 xmlns="">TSS</h4> The
                     evaluator shall examine the TSS to ensure that it describes how user authentication is
                     performed. The evaluator shall verify that the authorization methods listed in the TSS
                     are specified and included in the requirements in the ST. <br xmlns="">
                     <b xmlns="">Requirement met by the TOE</b>
                     <br xmlns=""> Nothing additional. <br xmlns="">
                     <b xmlns="">Requirement met by the platform</b><br xmlns=""> The evaluator shall examine the TSS to
                     ensure a description is included for how the TOE is invoking the platform
                     functionality and how it is getting an authorization value that has appropriate
                     entropy. 
                     <h4 xmlns="">Guidance</h4>The evaluator shall verify that the operational guidance
                     includes instructions for configuring the selected authorization method.
                     
                     <h4 xmlns="">Tests</h4>The evaluator shall ensure that authorization using each selected
                     method is tested during the cour0se of the evaluation, setting up the method as
                     described in the operational guidance and ensuring that authorization is successful.
                     
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
            <f-component id="FIA_FCT_EXT.1(1)" name="Extended: User Authorization with External Entity Authorization Factors" status="sel-based">
               
               <selection-depends req="FIA_AUT_EXT.1.1" ids="qqqq"></selection-depends>
               
               <f-element id="FIA_FCT_EXT.1.1(1)">
                  
                  <title>The TSF shall support an external entity authorization factor mechanism as
                     defined in FCS_CKM_EXT.1 and FCS_COP.1(5) to perform user authorization. 
                  </title>
                  
               </f-element>
               
               <f-element id="FIA_FCT_EXT.1.2(1)">
                  
                  <title>The TSF shall confirm that the user is authorized via the mechanism provided in
                     FIA_FCT_EXT.1.1(1) before allowing decryption of user data.
                  </title>
                  
               </f-element>
               
               <f-element id="FIA_FCT_EXT.1.3(1)">
                  
                  <title>The TSF shall support the use of multiple instances of authorization factors that
                     result in unique KEKs.
                  </title>
                  
               </f-element>
               
               <f-element id="FIA_FCT_EXT.1.4(1)">
                  
                  <title>The TSF shall receive an indication that the authorization factor is valid before
                     decrypting the user&#8217;s encrypted files. 
                  </title>
                  
                  <note role="application"> This requirement is used when an external entity (e.g.,
                     smartcard) contains a public/private key pair that is used to protect a FEK used to
                     decrypt the encrypted file (or set of files) owned by the user and thus gain access to
                     the data. It is fairly important to note that this is not considered authentication of
                     an individual user. While FIA_FCT_EXT.1.3(1) requires the TSF to support multiple
                     authorization factors to produce multiple KEKs, the intent is that the TSF supports a
                     system where multiple users have access to files on the underlying platform, and that
                     each user has an authorization factor so that they can protect their own files from
                     other users (this is in contrast to a full disk encryption product where a single
                     authorization factor allows access to all of the files on that disk). In this case it
                     would mean that the TOE is able to support multiple users each with their own
                     smartcard. <br xmlns="">User authorization only needs to be performed when a request to the
                     TOE for decrypt/encrypt services is made, not on each individual read and write for
                     that file. In the context of FIA_FCT_EXT.1.4(1), the notion is that the user will
                     enter (either facilitated by the TOE or directly into the external entity through a
                     facility outside of the TOE) the credentials needed to unlock the private key on the
                     external entity; if these credentials are not correct for the private key on the
                     external entity, then the TOE receives an indication from the external entity that the
                     authorization has failed and no decryption is performed. 
                  </note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4> The evaluator shall check the TSS section to confirm that it describes,
                     for each type of external entity authorization factor supported by the TOE, how a
                     request for each type of supported resource (file or set of files, etc.) to be
                     encrypted/decrypted is captured by the TOE; and how the TSF interacts with the
                     external entity to obtain a FEK with which to perform the desired operation. Scenarios
                     to be covered should include initial creation of the FEK, and using a FEK to
                     decrypt/encrypt an existing resource as well as to encrypt a resource for the first
                     time. If different resource types require different behavior by the TSF in terms its
                     interactions with external entities in unwrapping the FEK, then the evaluator shall
                     check to ensure that these cases are described as well. <br xmlns="">Since cryptographic
                     functions may be implemented in the Operational Environment to perform the wrapping
                     and unwrapping of the FEK, the evaluator shall check the TSS to ensure it
                     describes--for each platform and external entity identified in the ST--the
                     interface(s) used by the TOE to invoke this functionality. This must include the
                     interfaces used (if supported by the TOE) for entry of credentials used to decrypt the
                     private key, as well as the interfaces for passing the (encrypted or unencrypted, as
                     dictated by the implementation) FEK to the external entity and status from external
                     entity in terms of the validity of the authorization factors/FEKs. If the interface
                     conforms to a standard (e.g., PKCS #11), then it is sufficient for the evaluator to
                     ensure that the TSS describes how the TOE uses the standard interfaces, and that each
                     external entity claims to support that standard. Other interfaces must be described at
                     the level of an API call (for instance, a &#8220;man page&#8221; entry for *IX systems). For each
                     mode of FEK encryption used by the external entity, the evaluator shall check that the
                     TSS identifies (using the information contained in FCS_COP.1(4)) the algorithms
                     supported by each external entity, and any functionality implemented by the TSS to
                     ensure that that functionality is invoked. <br xmlns="">The evaluator shall check to ensure
                     that the TSS states that multiple users are able to invoke the TOE, each with their
                     own authorization factor. <br xmlns="">The evaluator shall check to ensure that the TSS
                     describes the method by which a user attempting to decrypt a file for which they do
                     not have the correct FEK is detected and dis-allowed. If this operation is performed
                     by the TSF, then the method by which an incorrect FEK is detected shall be described
                     in detail, including the information used in detected incorrect FEKs. If this
                     operation is performed by the external entity, then the evaluator checks to ensure
                     that the TSS describes the information that the TSF must present to the external
                     entity in order for this determination to be made, and how the response from the
                     external entity is indicated to the TSF. 
                     <h4 xmlns="">Guidance</h4> 1 The evaluator shall
                     ensure that any configuration needed to be performed on the TSF to support the
                     external entities listed in the ST (e.g., entry of private-key-credentials, algorithms
                     to use to encrypt FEK) shall be contained in the Operational Guidance. The evaluator
                     shall also verify that the Operational Guidance contains instructions on using each
                     external entity authorization factor claimed in the ST for each platform, and
                     describes any error indicators that may be returned in response to elements
                     FIA_FCT_EXT.1.2(1) and FIA_FCT_EXT.1.4(1). 
                     <h4 xmlns="">Tests</h4> The evaluator shall perform
                     the following tests (these tests may be conducted in concert with those specified for FDP_PRT_EXT.1):
                     <testlist>
                        
                        <test>For each external entity listed in the ST and resource type supported by the
                           TOE (file (or set of files)), ensure that correctly using the external entity
                           results in access to the protected resource. This activity must be performed using
                           all cryptographic FEK protection algorithms and private-key-entry options
                           identified in the TSS for each external entity. This activity must also be
                           performed for first-time encryption of a resource, as well as encryption and
                           decryption of an existing resource.
                        </test>
                        
                        <test>Choose (and describe the rationale in the test report) a representative sample
                           of different authorization factors (either instantiation of a single authorization
                           factor, or multiple different authorization factors), and demonstrate that they
                           can be used to protect different resource types on the same platform using the
                           TOE.
                        </test>
                        
                        <test>For each external entity listed in the ST and resource type supported by the
                           TOE (file (or set of files)), ensure that incorrect entry of the credential
                           protecting the private key results in a notification from the TOE that an
                           incorrect authorization has been provided. 
                        </test>
                        
                        <test>For each external entity and platform combination that is valid as listed in
                           the ST, and resource type supported by the TOE (file (or set of files)), ensure
                           that an attempt to decrypt a protected resource is not associated with the user
                           requesting access results in a notification from the TOE that an incorrect
                           authorization has been provided.
                        </test>
                        
                     </testlist>
                     
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
            <f-component id="FIA_FCT_EXT.1(3)" name="Extended: Single User Authorization with External Entity Authorization Factors" status="sel-based">
               
               <selection-depends req="FIA_AUT_EXT.1.1" ids="qqqq"></selection-depends>
               
               <f-element id="FIA_FCT_EXT.1.1(3)">
                  
                  <title>The TSF shall provide a mechanism as defined in FCS_CKM_EXT.1 and FCS_COP.1(4) to perform user authorization. </title>
                  
               </f-element>
               
               <f-element id="FIA_FCT_EXT.1.2(3)">
                  
                  <title> The TSF shall perform user authorization using the mechanism provided in FIA_FCT_EXT.1.1(3) before allowing decryption of
                     user data.
                  </title>
                  
               </f-element>
               
               <f-element id="FIA_FCT_EXT.1.3(3)">
                  
                  <title>The TSF shall verify that the user-entered authorization factors are valid before decrypting the user&#8217;s encrypted files..</title>
                  
               </f-element>
               
               <f-element id="FIA_FCT_EXT.1.4(3)">
                  
                  <title>The TSF shall ensure that the method of validation for each authorization factor does not expose or reduce the effective strength
                     of the KEK, FEK, or CSPs used to derive the KEK or FEK.
                  </title>
                  
               </f-element>
               
               <f-element id="FIA_FCT_EXT.1.5(3)">
                  
                  <title> The TSF shall perform user authorization using the mechanism provided in FIA_FCT_EXT.1.1(3) before allowing the user to change
                     the passphrase-based authorization factor as specified in FMT_SMF.1(c).
                  </title>
                  
                  <note role="application"> 
                     If the TSF supports multiple authorization factors to produce multiple KEKs, this requirement does not apply and FIA_FCT_EXT.1(2)
                     must be claimed.
                     
                     The intent of this requirement is to specify the password and/or passphrase mechanisms by which a single user is authorized
                     to decrypt the encrypted file (or set of files) and thus gain access to their data. It is fairly important to note that this
                     is not considered authentication of an individual user. There is no requirement that the TSF even understand the concept of
                     a &#8220;user&#8221; in the context of a file owner; it should merely be able to tell (FIA_FCT_EXT.1.3(3)) if the authorization factor
                     presented is valid for the file being requested, and if so, perform the appropriate cryptographic operations on that file.
                     User authorization only needs to be performed when a request to the TOE for decrypt/encrypt services is made, not on each
                     individual read and write for that file.
                     
                     Since the TSF is responsible for manipulating the password/passphrase authorization factor itself, in this case FIA_FCT_EXT.1.1(3)
                     and FIA_FCT_EXT.1.2(3) mean that the TSF itself provides the mechanism to prompt the user for the authorization factors, verify
                     that the authorization factors are valid, transform the authorization factor into a KEK, and then use the KEK to decrypt the
                     FEK so that the data can be accessed.
                     
                     Elements 1.3(3) and 1.4(3) deal with the validation of the authorization factors provided by the user prior to a user being
                     able to access the information in the file (or set of files). If a password/passphrase authorization factor is not valid,
                     it is undesirable to unmask the FEK and use it to decrypt the file (or set of files) and present gibberish to the user. However,
                     checking that the authorization factor is valid should not be done in a way that allows an attacker to circumvent the other
                     requirements; since this operation may be done on the host, it may be monitored/disassembled by an attacker and so must be
                     designed with this threat in mind. In the case that the TOE supports external authorization factors, this provision means
                     that the external entity must have a way of signaling to the TSF that the authorization factor was not valid (which means
                     that the information provided to decrypt the secret key was invalid), rather than just pass back an incorrectly-derived KEK
                     (as ECC CDH does) or decrypted FEK (as RSA decryption does) for the TSF to use.
                     
                     FIA_FCT_EXT.1.5(3) covers the case that the user wishes to change their password- or passphrase-based authorization factor
                     such that the user authorization functionality will have to be invoked prior to the change being completed.
                  </note>
                  
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4> The evaluator shall check the TSS section to confirm that it describes how a request for each type of supported resource
                     (file (or set of files)) to be encrypted/decrypted is captured by the TOE; how the user is prompted for an authorization factor,
                     and how the KEK is formed.
                     
                     The evaluator shall check that the TSS describes how the authorization factors are validated prior to allowing the user to
                     access the data on a drive or change their passphrase. This description shall be in enough detail so that the evaluator can
                     determine that the method or methods used do not expose the FEK, KEK, or other key material. 'Expose' also includes the notion
                     of weakening the FEK or KEK. It is not required to have a separate method for checking each authorization factor if separate
                     authorization factors are used to provide submasks to create the KEK. The evaluator shall document their analysis of the mechanism(s)
                     used to authenticate the authorization factors in the test report (ATE_IND).
                     
                     The evaluator shall ensure the TSS describes how updates to the current authorization factor are handled, to include verifying
                     that a change to the authorization factor cannot occur prior to providing the original authorization factor and that once
                     the update has transpired the original authorization factor would no longer be effective.
                     
                     For the cryptographic functions implemented in the Operational Environment that are used by the TOE in implementing this component,
                     the evaluator shall check the TSS to ensure it describes--for each platform identified in the ST&#8212;the interface(s) used by
                     the TOE to invoke this functionality.
                     
                     
                     <h4 xmlns="">Guidance</h4> The evaluator shall check that the Operational Guidance contains information so that users understand how authorization factors
                     are entered, and the resources that are protectable by the TOE in each platform listed in the ST. They shall also check to
                     ensure it describes the method by which a user changes their password/passphrase authorization factor.
                     
                     
                     <h4 xmlns="">Tests</h4> The evaluator shall perform the following tests (these tests may be conducted in concert with those specified for FDP_PRT_EXT.1
                     above):
                     
                     <testlist>
                        
                        <test>For each authorization factor and resource type supported by the TOE (file (or set of files)), ensure that the authorization
                           factors are prompted for prior to allowing any access to the protected resource. This activity must be performed using all
                           cryptographic FEK protection algorithms identified in the TSS for each external entity. This activity must also be performed
                           for first-time encryption of a resource, as well as encryption and decryption of an existing resource.
                        </test>
                        
                        <test>For each authorization factor and resource type supported by the TOE (file (or set of files)), ensure that incorrect entry
                           of an authorization factor results in a notification from the TOE that an incorrect authorization has been provided.
                        </test>
                        
                     </testlist>
                     
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
         </subsection>
         
         <subsection title="Security Management (FMT)" id="fmt"> 
            
            <f-component id="FMT_SMF.1" name="Specification of Management Functions">
               
               <f-element id="FMT_SMF.1.1">
                  
                  <title>The TSF shall be capable of performing the following management functions:
                     
                     <selectables linebreak="yes">
                        
                        <selectable>no other function</selectable>
                        
                        <selectable>configure cryptographic functionality</selectable>
                        
                        <selectable>change authentication factors</selectable>
                        
                        <selectable>disable key revoery functionality</selectable>
                        
                        <selectable>
                           <assignable>other management functions provided by the TSF</assignable>
                        </selectable>
                        
                     </selectables>
                     
                  </title>
                  
                  <note role="application"> The intent of this requirement is to express the management
                     capabilities that may be included in the TOE. Several common options are given:<br xmlns="">
                     
                     <ul xmlns="">
                        
                        <li>If password or passphrase authorization factors are implemented by the TOE, then
                           the appropriate &#8220;change&#8221; selection must be included, along with FIA_FCT_EXT.1(2) or FIA_FCT_EXT.1(3)
                           from Appendix C.
                        </li>
                        
                        <li>If the TOE provides for a password/passphrase complexity setting, then
                           &#8220;configure password/passphrase complexity setting&#8221; will be included, and the
                           specifics of the functionality offered can either be written from the requirement
                           as bullets points, or included in the TSS.
                        </li>
                        
                        <li>If the TOE provides configurability of the cryptographic functions (for example,
                           key size of the FEK)&#8212;even if the configuration is the form of parameters that may
                           be passed to cryptographic functionality implement on the TOE platform--then
                           &#8220;configure cryptographic functionality&#8221; will be included, and the specifics of the
                           functionality offered can either be written in this requirement as bullet points,
                           or included in the TSS.
                        </li>
                        
                        <li>If the TOE does include a key recovery function, the TOE must provide the
                           capability for the user to turn this functionality off so that no recovery key is
                           generated and no keys are permitted to be exported.
                        </li>
                        
                        <li>If &#8220;other management functions&#8221; are assigned, a validation authority must be
                           consulted to ensure the assurance activities and other functionality requirements
                           that may be needed are appropriately specified so that the ST can claim
                           conformance to this EP.
                        </li>
                        
                     </ul>
                     
                  </note>
                  
                  <aactivity>The assurance activities for this component will be driven by the selections
                     made by the ST author. This section describes assurance activities for all possible
                     selections in an ST; it should be understood that if a capability is not selected in
                     the ST, the noted assurance activity does not need to be performed. The following
                     sections are divided up into &#8220;Required Activities&#8221; and &#8220;Conditional Activities&#8221; for
                     ease of reference. 
                     
                     As the Application Software PP already includes FMT_SMF.1, the ST author should combine the selections 
                     (and assignment, if performed) with those in the FMT_SMF.1 requirement in the Application Software PP to 
                     form a single FMT_SMF.1 SFR in the ST. The intent of this requirement is to express the management 
                     capabilities that may be included in the TOE. Several common options are given:
                     
                     If password or passphrase authorization factors are implemented by the TOE, then the appropriate 
                     &#8220;change&#8221; selection must be included, along with FIA_FCT_EXT.1(2) from Appendix C.
                     
                     If the TOE provides configurability of the cryptographic functions (for example, key size of the FEK)&#8212;
                     even if the configuration is the form of parameters that may be passed to cryptographic functionality 
                     implement on the TOE platform--then &#8220;configure cryptographic functionality&#8221; will be included, and the specifics 
                     of the functionality offered can either be written in this requirement as bullet points, or included in the TSS.
                     
                     If the TOE does include a key recovery function, the TOE must provide the capability for the user to turn this 
                     functionality off so that no recovery key is generated and no keys are permitted to be exported.
                     
                     If &#8220;other management functions&#8221; are assigned, a validation authority must be consulted to ensure the 
                     assurance activities and other functionality requirements that may be needed are appropriately 
                     specified so that the ST can claim conformance to this EP.
                     
                     
                     <h4 xmlns="">TSS</h4>
                     <b xmlns="">Conditional Activities:</b> The evaluator shall examine the TSS to ensure that it
                     describes the sequence of activities that take place from an implementation
                     perspective when this activity is performed (for example, how it determines which
                     resources are associated with the KEK, the decryption and re-encryption process), and
                     ensure that the KEK and FEK are not exposed during this change. <br xmlns="">
                     <b xmlns="">Cryptographic Configuration:</b> None for this requirement. <br xmlns="">
                     <b xmlns="">Disable Key Recovery:</b> If the TOE supports key recovery, this must be stated in
                     the TSS. The TSS shall also describe how to disable this functionality. This includes
                     a description of how the recovery material is provided to the recovery holder. The
                     guidance for disabling this capability shall be described in the AGD documentation.
                     
                     <h4 xmlns="">Guidance</h4>
                     <b xmlns="">Conditional Activities:</b> The evaluator shall examine the Operational Guidance to
                     ensure that it describes how the password/passphrase-based authorization factor is to
                     be changed. <br xmlns="">
                     <b xmlns="">Cryptographic Configuration:</b> The evaluator shall determine from the TSS for
                     other requirements (FCS_*, FDP_PRT_EXT, FIA_AUT_EXT) what portions of the
                     cryptographic functionality are configurable. The evaluator shall then review the AGD
                     documentation to determine that there are instructions for manipulating all of the
                     claimed mechanisms. 
                     <h4 xmlns="">Tests</h4>
                     <b xmlns="">Disable Key Recovery:</b> If the TOE provides key recovery capability, then the
                     evaluator shall devise a test that ensures that the key recovery capability has been
                     or can be disabled following the guidance provided by the vendor. <br xmlns="">
                     <b xmlns="">Cryptographic Configuration:</b> Testing for this activity is performed for other
                     components in this EP. 
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
            <f-component id="FMT_MEC_EXT.1" name="Supported Configuration Mechanism">
               
               <f-element id="FMT_MEC_EXT.1.1">
                  
                  <title>The TSF shall 
                     
                     <selectables>
                        
                        <selectable>invoke the mechanisms recommended by the platform vendor for storing and setting configuration options</selectable>
                        
                        <selectable>store and protect configuration options as specified in FCS_COP.1(1)]</selectable>                
                        
                     </selectables>.
                     
                  </title>
                  
                  <note role="application"> The ST author replaces FMT_MEC_EXT.1 in the Application Software PP with this requirement, 
                     and performs the appropriate selections.  The ST author ensures all configuration options are "covered" by one of 
                     the two selections.  It is allowable to have some configuration stored and protected using platform-provided functions 
                     and some stored by the TSF and protected using encryption per FCS_COP.1(1).
                     
                  </note>
                  
                  <aactivity>The TSS assurance activity in the Application Software PP for FMT_MEC_EXT.1 applies for either selection.  
                     Additionally, if "store and protect configuration options as specified in FCS_COP.1(1)" is selected, the evaluator 
                     shall ensure that the TSS identifies those options, as well as indicates where the encrypted representation of these options
                     is stored.
                     
                     The test assurance activites in the Application Software PP for FMT_MEC_EXT.1 apply to all configuration options 
                     identified as being stored and set using platform mechanisms.  The following test activity applies to any configuration 
                     options identified as being stored and protected using encryption per FCS_COP.1(1).
                     
                     [Conditional] For all configuration options listed in the TSS as being stored and protected using encryption 
                     per FCS_COP.1(1), the evaluator shall examine the contents of the configuration option storage (identified in the TSS) to
                     
                     determine that the options have been encrypted. 
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
         </subsection>
         
         <subsection title="Protection of the TSF (FPT)" id="fpt">
            
            
            
            <f-component id="FPT_KYP_EXT.1" name="Extended: Protection of Key and Key Material (FPT_KYP_EXT)">
               
               <f-element id="FPT_KYP_EXT.1.1">
                  
                  <title>The TSF shall 
                     
                     <selectables>
                        
                        <selectable>not store keys in non-volatile memory</selectable>
                        
                        <selectable>only store keys in non-volatile memory when
                           
                           <selectables>
                              
                              <selectable>wrapped, as specified in FCS_COP.1(5)</selectable>
                              
                              <selectable>encrypted, as specified in FCS_COP.1(1)</selectable>
                              
                              <selectable>stored in the underlying platofrm's keystore as specified by FCS_STO_EXT.1.1</selectable>
                              
                              <selectable>the plaintext key will no longer provide access to the encrypted data after initial provisioning</selectable>
                              
                              <selectable>the plaintext key is a key split that is combined as spcified in FCS_SMC_EXT.1 and another contribution to the split is
                                 
                                 <selectables>
                                    
                                    <selectable>wrapped as specified in FCS_COP.1(5) or encrypted as specified in FCS_COP.1(1)</selectable>
                                    
                                    <selectable>derived and not stored in non-volatile memory</selectable>
                                    
                                 </selectables>
                                 
                              </selectable>
                              
                              <selectable>the plaintext key is stored on an external storage device for use as an authorization factor.</selectable>
                              
                              <selectable>the plaintext key is used to encrypt a key as specified in FCS_COP.1(1) or wrap a key as specified in FCS_COP.1(5) 
                                 that is already encrypted as specified in FCS_COP.1(1) or wrapped as specified in FCS_COP.1(5)
                              </selectable>
                              
                           </selectables>
                           
                        </selectable>
                        
                     </selectables>.
                     
                  </title>
                  
                  <note role="application">The plaintext key storage in non-volatile memory is allowed for
                     several reasons. If the keys exist within protected memory that is not user accessible
                     on the TOE or OE, the only methods that allow it to play a security relevant role for
                     protecting the FEK is if it is a key split or providing additional layers of wrapping
                     or encryption on keys that have already been protected. 
                  </note>
                  
                  <aactivity>
                     
                     <h4 xmlns="">TSS</h4> INSERT FDE TEST The evaluator shall verify the TSS for a high level description of method
                     used to protect keys stored in non-volatile memory.<br xmlns=""> The evaluator shall verify
                     the TSS to ensure it describes the storage location of all keys and the protection of
                     all keys stored in non-volatile memory. The description of the key chain shall be
                     reviewed to ensure FCS_COP.1(5) is followed for the storage of wrapped or encrypted
                     keys in non-volatile memory and plaintext keys in non-volatile memory meet one of the
                     criteria for storage. 
                     <h4 xmlns="">Guidance</h4> None. 
                     <h4 xmlns="">Tests</h4> None. 
                  </aactivity>
                  
               </f-element>
               
            </f-component>
            
         </subsection>
         
      </section>
      
   </chapter>
   
   
   <appendix id="optreqs" title="Optional Requirements"> As indicated in the introduction to this EP,
      the baseline requirements (those that must be performed by the TOE or its underlying platform)
      are contained in the body of this EP. Additionally, there are three other types of requirements
      specified in Appendices B, C, and D. <br xmlns=""> The first type (in this Appendix) are optional
      requirements that can be included in the ST, but do not have to be in order for a TOE to claim
      conformance to this EP. The second type (in Appendix C) are requirements based on selections in
      the body of the EP: if certain selections are made, then additional requirements in that
      appendix will need to be included. The third type (in Appendix D) are components that are not
      required in order to conform to this PP, but will be included in the baseline requirements in
      future versions of this EP, so adoption by File Encryption Product vendors is encouraged. Note
      that the ST author is responsible for ensuring that requirements that may be associated with
      those in Appendix B, Appendix C, and/or Appendix D but are not listed (e.g., FMT-type
      requirements) are also included in the ST. 
      
   </appendix>
   
   
   <appendix id="sbr" title="Selection Based Requirements">As indicated in the introduction to this
      EP, the baseline requirements (those that must be performed by the TOE) are contained in the
      body of this EP. There are additional requirements based on selections in the body of the EP: if
      certain selections are made, then additional requirements below will need to be included.
      
   </appendix>
   
   
   <appendix id="objreq" title="Objective Requirements"> As indicated in the introduction to this EP,
      the baseline requirements (those that must be performed by the TOE) are contained in the body of
      this EP. There are additional requirements that specify security functionality that is desirable
      and these requirements are contained in this Appendix. It is expected that these requirements
      will transition from objective requirements to baseline requirements in future versions of this
      EP. <br xmlns=""> These requirements may be included in the ST and the TOE will still be able to claim
      conformance to this EP. <br xmlns=""> There are no objective requirements at this time. 
      
   </appendix>
   
   
   <appendix id="biblio" title="References">
      
      <bibliography>
         
         <entry id="bibCC">
            
            <tag>CC</tag>
            
            <description>Common Criteria for Information Technology Security Evaluation - 
               <ul xmlns="">
                  
                  <li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART1V3.1R4.pdf">Part
                        1: Introduction and General Model</a>, CCMB-2012-09-001, Version 3.1 Revision 4,
                     September 2012.
                  </li>
                  
                  <li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART2V3.1R4.pdf">Part
                        2: Security Functional Components</a>, CCMB-2012-09-002, Version 3.1 Revision 4,
                     September 2012.
                  </li>
                  
                  <li><a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART3V3.1R4.pdf">Part
                        3: Security Assurance Components</a>, CCMB-2012-09-003, Version 3.1 Revision 4,
                     September 2012.
                  </li>
                  
               </ul>
            </description>
            
         </entry>
         
         <entry id="bibAppPP">
            
            <tag>AppPP</tag>
            
            <description>
               <a xmlns="" href="https://www.niap-ccevs.org/pp/">Protection Profile for Application Software</a>
               
            </description>
            
         </entry>
         
         <entry id="FIPS140-2">
            
            <tag>FIPS140-2</tag>
            
            <description> Federal Information Processing Standard Publication (FIPS-PUB) 140-2, Security
               Requirements for Cryptographic Modules, National Institute of Standards and Technology,
               March 19, 2007 
            </description>
            
         </entry>
         
         <entry id="FIPS180-4">
            
            <tag>FIPS180-4</tag>
            
            <description> Federal Information Processing Standards Publication (FIPS-PUB) 180-4, Secure
               Hash Standard, March, 2012 
            </description>
            
         </entry>
         
         <entry id="FIPS186-4">
            
            <tag>FIPS186-4</tag>
            
            <description> Federal Information Processing Standard Publication (FIPS-PUB) 186-4, Digital
               Signature Standard (DSS), National Institute of Standards and Technology, July 2013
               
            </description>
            
         </entry>
         
         <entry id="FIPS197">
            
            <tag>FIPS197</tag>
            
            <description>Federal Information Processing Standards Publication (FIPS-PUB) 197,
               Specification for the Advanced Encryption Standard (AES), November 26, 2001 
            </description>
            
         </entry>
         
         <entry id="FIPS198-1">
            
            <tag>FIPS198-1</tag>
            
            <description>Federal Information Processing Standards Publication (FIPS-PUB) 198-1, The
               Keyed-Hash Message Authentication Code (HMAC), July 2008 
            </description>
            
         </entry>
         
         <entry id="SP800-38A">
            
            <tag>NIST800-38A</tag>
            
            <description>NIST Special Publication 800-38A, Recommendation for Block Cipher Modes of
               Operation: Methods and Techniques, 2001 Edition 
            </description>
            
         </entry>
         
         <entry id="SP800-56A">
            
            <tag>NIST800-56A</tag>
            
            <description>NIST Special Publication 800-56A, Recommendation for Pair-Wise Key
               Establishment Schemes Using Discrete Logarithm Cryptography (Revised), March 2007
               
            </description>
            
         </entry>
         
         <entry id="SP800-56B">
            
            <tag>NIST800-56B</tag>
            
            <description>NIST Special Publication 800-56B, Recommendation for Pair-Wise Key
               Establishment Schemes Using Integer Factorization Cryptography, August 2009 
            </description>
            
         </entry>
         
         <entry id="SP800-90">
            
            <tag>NIST800-90</tag>
            
            <description>NIST Special Publication 800-90, Recommendation for Random Number Generation
               Using Deterministic Random Bit Generators (Revised), March 2007 
            </description>
            
         </entry>
         
         <entry id="SP800-132">
            
            <tag>NIST800-132</tag>
            
            <description>NIST Special Publication 800-132, Recommendation for Password-Based Key
               Derivation, December 2010 
            </description>
            
         </entry>
         
         <entry id="SP800-38F">
            
            <tag>NIST800-38F</tag>
            
            <description>NIST Special Publication 800-38F,Recommendation for Block Cipher Modes of
               Operation: Methods for Key Wrapping, December 2012 
            </description>
            
         </entry>
         
      </bibliography>
      
   </appendix>
   
   <appendix id="acronyms" title="Acronyms">
      
      <acronyms>
         
         <entry>
            
            <term>AES</term>
            
            <description>Advanced Encryption Standard</description>
            
         </entry>
         
         <entry>
            
            <term>CC</term>
            
            <description>Common Criteria</description>
            
         </entry>
         
         <entry>
            
            <term>CM</term>
            
            <description></description>
            
         </entry>
         
         <entry>
            
            <term>FAK</term>
            
            <description>File Authentication Key</description>
            
         </entry>
         
         <entry>
            
            <term>FEK</term>
            
            <description>File Encryption Key</description>
            
         </entry>
         
         <entry>
            
            <term>DRBG</term>
            
            <description>Deterministic Random Bit Generator</description>
            
         </entry>
         
         <entry>
            
            <term>EAL</term>
            
            <description>Evaluation Assurance Level</description>
            
         </entry>
         
         <entry>
            
            <term>ECC</term>
            
            <description>Elliptic Curve Cryptography</description>
            
         </entry>
         
         <entry>
            
            <term>ECC CDH</term>
            
            <description>Elliptic Curve Cryptography Cofactor Diffie-Hellman (see NIST SP 800-56A rev 2,
               section 6.2.2.2)
            </description>
            
         </entry>
         
         <entry>
            
            <term>EP</term>
            
            <description>Extended Package</description>
            
         </entry>
         
         <entry>
            
            <term>FIPS</term>
            
            <description>Federal Information Processing Standards</description>
            
         </entry>
         
         <entry>
            
            <term>ISSE</term>
            
            <description>Information System Security Engineers</description>
            
         </entry>
         
         <entry>
            
            <term>IT</term>
            
            <description>Information Technology</description>
            
         </entry>
         
         <entry>
            
            <term>KDF</term>
            
            <description>Key Derivation Function</description>
            
         </entry>
         
         <entry>
            
            <term>KEK</term>
            
            <description>Key Encryption Key</description>
            
         </entry>
         
         <entry>
            
            <term>PBKDF</term>
            
            <description>Password-Based Key Derivation Function</description>
            
         </entry>
         
         <entry>
            
            <term>PIN</term>
            
            <description>Personnel Identification Number</description>
            
         </entry>
         
         <entry>
            
            <term>PKI</term>
            
            <description>Public Key Infrastructure</description>
            
         </entry>
         
         <entry>
            
            <term>PP</term>
            
            <description>Protection Profile</description>
            
         </entry>
         
         <entry>
            
            <term>PUB</term>
            
            <description>Publication</description>
            
         </entry>
         
         <entry>
            
            <term>RBG</term>
            
            <description>Random Bit Generator </description>
            
         </entry>
         
         <entry>
            
            <term>SAR</term>
            
            <description>Security Assurance Requirement</description>
            
         </entry>
         
         <entry>
            
            <term>SF</term>
            
            <description>Security Function</description>
            
         </entry>
         
         <entry>
            
            <term>SFR</term>
            
            <description>Security Functional Requirement</description>
            
         </entry>
         
         <entry>
            
            <term>ST</term>
            
            <description>Security Target</description>
            
         </entry>
         
         <entry>
            
            <term>TOE</term>
            
            <description>Target of Evaluation</description>
            
         </entry>
         
         <entry>
            
            <term>TSF</term>
            
            <description>TOE Security Functionality</description>
            
         </entry>
         
         <entry>
            
            <term>TSFI</term>
            
            <description>TSF Interface</description>
            
         </entry>
         
         <entry>
            
            <term>TSS</term>
            
            <description>TOE Summary Specification </description>
            
         </entry>
         
      </acronyms>
      
   </appendix>
   
</PP>